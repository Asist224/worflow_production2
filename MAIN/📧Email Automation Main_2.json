{
  "name": "üìßEmail Automation Main_2",
  "nodes": [
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        -17312,
        -3136
      ],
      "id": "8cd378f5-d3ea-45d3-840d-49cfc1ac6355",
      "name": "Gemini Model Reply",
      "credentials": {
        "googlePalmApi": {
          "id": "abo0BDHSJPM0pgRU",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// –ü–∞—Ä—Å–∏–º –æ—Ç–≤–µ—Ç AI –∞–≥–µ–Ω—Ç–∞\nconst aiResponse = $input.first().json;\nconst historyData = $json;\nconst clientEmail = $('Get History').first().json.email;\n\nconst retryCount = historyData.retryCount || 0;\nif (retryCount > 2) {\n  return []; // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–æ—Å–ª–µ 3 –ø–æ–ø—ã—Ç–æ–∫\n}\n\nlet emailContent = '';\nlet shouldSendReply = true;\nlet replyData = {};\n\ntry {\n  // –ü–æ–ª—É—á–∞–µ–º output –æ—Ç AI\n  let output = aiResponse.output;\n  \n  if (typeof output === 'string') {\n    const trimmedOutput = output.trim();\n    \n    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –ª–∏ —Å HTML —Ç–µ–≥–æ–≤\n    if (trimmedOutput.startsWith('<!DOCTYPE') || \n        trimmedOutput.startsWith('<html')) {\n      // –≠—Ç–æ —á–∏—Å—Ç—ã–π HTML\n      emailContent = trimmedOutput;\n    } else {\n      // –≠—Ç–æ JSON - –Ω—É–∂–Ω–æ —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å\n      try {\n        // –û—á–∏—â–∞–µ–º –æ—Ç markdown –±–ª–æ–∫–æ–≤ –∫–æ–¥–∞\n        const cleanJson = trimmedOutput\n          .replace(/```json\\n?/g, '')\n          .replace(/```\\n?/g, '')\n          .trim();\n        \n        // –ü–∞—Ä—Å–∏–º JSON\n        const parsedData = JSON.parse(cleanJson);\n        \n        // –ò–∑–≤–ª–µ–∫–∞–µ–º –¥–∞–Ω–Ω—ã–µ\n        if (parsedData.replyData && parsedData.replyData.emailContent) {\n          emailContent = parsedData.replyData.emailContent;\n          replyData = parsedData;\n        } else if (parsedData.emailContent) {\n          emailContent = parsedData.emailContent;\n          replyData = parsedData;\n        } else {\n          // –ú–æ–∂–µ—Ç –±—ã—Ç—å –≤–ª–æ–∂–µ–Ω–Ω—ã–π JSON –≤ —Å—Ç—Ä–æ–∫–µ?\n          // –ü–æ–ø—Ä–æ–±—É–µ–º —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å emailContent –µ—Å–ª–∏ –æ–Ω —Å—Ç—Ä–æ–∫–∞ —Å JSON\n          if (typeof parsedData === 'string' && parsedData.includes('emailContent')) {\n            const innerParsed = JSON.parse(parsedData);\n            if (innerParsed.replyData && innerParsed.replyData.emailContent) {\n              emailContent = innerParsed.replyData.emailContent;\n              replyData = innerParsed;\n            }\n          }\n        }\n        \n        // –ü—Ä–æ–≤–µ—Ä—è–µ–º shouldReply\n        if (parsedData.shouldReply === false) {\n          shouldSendReply = false;\n        }\n        \n      } catch (parseError) {\n        console.error('–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON:', parseError);\n        // –ú–æ–∂–µ—Ç –±—ã—Ç—å HTML –∑–∞–º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω –ø–æ–¥ —Å—Ç—Ä–æ–∫—É\n        if (trimmedOutput.includes('<!DOCTYPE') || trimmedOutput.includes('<html')) {\n          // –ü–æ–ø—Ä–æ–±—É–µ–º –∏–∑–≤–ª–µ—á—å HTML –∏–∑ —Å—Ç—Ä–æ–∫–∏\n          const htmlMatch = trimmedOutput.match(/<!DOCTYPE[\\s\\S]*<\\/html>/);\n          if (htmlMatch) {\n            emailContent = htmlMatch[0];\n          }\n        }\n      }\n    }\n  } else if (typeof output === 'object') {\n    replyData = output;\n    if (replyData.replyData && replyData.replyData.emailContent) {\n      emailContent = replyData.replyData.emailContent;\n    } else if (replyData.emailContent) {\n      emailContent = replyData.emailContent;\n    }\n  }\n  \n} catch (e) {\n  console.error('–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ AI –æ—Ç–≤–µ—Ç–∞:', e);\n  return [];\n}\n\n// –ï—Å–ª–∏ –Ω–µ –Ω—É–∂–Ω–æ –æ—Ç–≤–µ—á–∞—Ç—å\nif (!shouldSendReply) {\n  console.log('AI —Ä–µ—à–∏–ª –Ω–µ –æ—Ç–≤–µ—á–∞—Ç—å');\n  return [];\n}\n\n// –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –µ—Å—Ç—å HTML –∫–æ–Ω—Ç–µ–Ω—Ç\nif (!emailContent || !emailContent.includes('<')) {\n  console.error('HTML –∫–æ–Ω—Ç–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π:', emailContent.substring(0, 100));\n  return [];\n}\n\n// –ï—Å–ª–∏ –Ω–µ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç–∞ - –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Ñ–ª–∞–≥ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–∞\nif (!emailContent || emailContent.length < 50) {\n  return [{\n    json: {\n      needsRetry: true,\n      email: clientEmail,\n      retryCount: retryCount + 1,  // –ó–î–ï–°–¨ —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫\n      ...historyData\n    }\n  }];\n}\n\n// –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏\nreturn [{\n  json: {\n    to: clientEmail,\n    subject: $('Loop Over Items').first().json.subject,\n    emailContent: emailContent, // –¢–æ–ª—å–∫–æ HTML!\n    language: replyData.replyData?.language || historyData.language || 'ru',\n    attachments: replyData.replyData?.attachments || [],\n    threadId: historyData.thread_id,\n    messageId: historyData.messageId,\n    originalBody: historyData.conversation_history || '',\n    senderName: historyData.full_name || 'Client',\n    urgency: replyData.replyData?.urgency || 'medium',\n    leadScore: replyData.clientData?.leadScore || historyData.lead_score || 0,\n    intent: replyData.clientData?.intent || 'information',\n    internalNote: replyData.internalNote || '',\n    followUpDays: replyData.replyData?.followUpDays || 3\n  }\n}];"
      },
      "id": "8c17bd54-ce0f-488e-a26f-21a2250ab6c9",
      "name": "Parse AI Reply",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -16944,
        -3328
      ]
    },
    {
      "parameters": {
        "sendTo": "={{ $json.to }}",
        "subject": "={{ $json.subject }}",
        "message": "={{ $json.emailContent }}",
        "options": {
          "appendAttribution": false,
          "bccList": "",
          "ccList": "",
          "senderName": "Cryptomator Team",
          "replyTo": "={{ $json.to }}"
        }
      },
      "id": "286c654d-ec93-40c0-aa20-47ee39782ebb",
      "name": "Send Gmail Reply",
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        -18208,
        -2992
      ],
      "webhookId": "8eb71c68-b6e1-41b8-b35d-cb51b60a4b61",
      "credentials": {
        "gmailOAuth2": {
          "id": "ev0cwU3ZEXqPZ9wU",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "operation": "markAsRead",
        "messageId": "={{ $items('Process Incoming')[0].json.messageId }}"
      },
      "id": "870b9ba2-f8cd-4fbd-9741-c7fb46a94760",
      "name": "Mark as Read",
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        -17824,
        -2992
      ],
      "webhookId": "3a5b53fc-89d0-4694-a5b3-4bd8fe1bd679",
      "credentials": {
        "gmailOAuth2": {
          "id": "ev0cwU3ZEXqPZ9wU",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// –ì–æ—Ç–æ–≤–∏–º –∫—Ä–∞—Å–∏–≤—ã–π –æ—Ç—á–µ—Ç –¥–ª—è Telegram —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º\nconst emailData = $input.first().json;\n\n// –§—É–Ω–∫—Ü–∏—è –¥–ª—è —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –¢–û–õ–¨–ö–û –æ–ø–∞—Å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤ –¥–ª—è Markdown v2\nfunction escapeMarkdown(text) {\n  if (!text) return '';\n  // –≠–∫—Ä–∞–Ω–∏—Ä—É–µ–º —Ç–æ–ª—å–∫–æ —Å–∏–º–≤–æ–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –ª–æ–º–∞—é—Ç Markdown\n  return String(text)\n    .replace(/\\\\/g, '\\\\\\\\')  // –û–±—Ä–∞—Ç–Ω—ã–π —Å–ª–µ—à\n    .replace(/\\*/g, '\\\\*')   // –ó–≤–µ–∑–¥–æ—á–∫–∞\n    .replace(/_/g, '\\\\_')    // –ü–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏–µ\n    .replace(/\\[/g, '\\\\[')   // –ö–≤–∞–¥—Ä–∞—Ç–Ω—ã–µ —Å–∫–æ–±–∫–∏\n    .replace(/\\]/g, '\\\\]')\n    .replace(/\\(/g, '\\\\(')   // –ö—Ä—É–≥–ª—ã–µ —Å–∫–æ–±–∫–∏\n    .replace(/\\)/g, '\\\\)')\n    .replace(/~/g, '\\\\~')    // –¢–∏–ª—å–¥–∞\n    .replace(/`/g, '\\\\`')    // –û–±—Ä–∞—Ç–Ω–∞—è –∫–∞–≤—ã—á–∫–∞\n    .replace(/>/g, '\\\\>')    // –ë–æ–ª—å—à–µ\n    .replace(/#/g, '\\\\#')    // –†–µ—à–µ—Ç–∫–∞\n    .replace(/\\+/g, '\\\\+')   // –ü–ª—é—Å\n    .replace(/-/g, '\\\\-')    // –ú–∏–Ω—É—Å\n    .replace(/=/g, '\\\\=')    // –†–∞–≤–Ω–æ\n    .replace(/\\|/g, '\\\\|')   // –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è —á–µ—Ä—Ç–∞\n    .replace(/\\{/g, '\\\\{')   // –§–∏–≥—É—Ä–Ω—ã–µ —Å–∫–æ–±–∫–∏\n    .replace(/\\}/g, '\\\\}')\n    .replace(/\\./g, '\\\\.')   // –¢–æ—á–∫–∞\n    .replace(/!/g, '\\\\!');   // –í–æ—Å–∫–ª–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π –∑–Ω–∞–∫\n}\n\nconst urgencyEmoji = {\n  'high': 'üî¥',\n  'medium': 'üü°', \n  'low': 'üü¢'\n};\n\nconst intentEmoji = {\n  'purchase': 'üí∞',\n  'information': '‚ÑπÔ∏è',\n  'support': 'üõ†Ô∏è',\n  'complaint': '‚ö†Ô∏è'\n};\n\n// –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –ø–æ–ª–µ–π\nconst safeName = escapeMarkdown(emailData.senderName || emailData.to || '–ö–ª–∏–µ–Ω—Ç');\nconst safeEmail = escapeMarkdown(emailData.to || '–Ω–µ —É–∫–∞–∑–∞–Ω');\nconst safeSubject = escapeMarkdown(emailData.subject || '–ë–µ–∑ —Ç–µ–º—ã');\nconst safeNote = escapeMarkdown(emailData.internalNote || '–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç–≤–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω');\n\n// –§–æ—Ä–º–∏—Ä—É–µ–º –∫—Ä–∞—Å–∏–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å Markdown V2\nconst message = `üìß *–ê–≤—Ç–æ–æ—Ç–≤–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω*\n\nüë§ *–ö–ª–∏–µ–Ω—Ç:* ${safeName}\nüìÆ *Email:* ${safeEmail}\nüìù *–¢–µ–º–∞:* ${safeSubject}\nüåê *–Ø–∑—ã–∫:* ${emailData.language === 'ru' ? 'üá∑üá∫ –†—É—Å—Å–∫–∏–π' : 'üá¨üáß English'}\n\n${urgencyEmoji[emailData.urgency] || 'üü°'} *–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:* ${emailData.urgency || 'medium'}\n${intentEmoji[emailData.intent] || '‚ÑπÔ∏è'} *–ù–∞–º–µ—Ä–µ–Ω–∏–µ:* ${emailData.intent || 'information'}\nüíØ *Lead Score:* ${emailData.leadScore || 0}/100\n\nüìå *–ó–∞–º–µ—Ç–∫–∞:* ${safeNote}\n‚è∞ *Follow\\\\-up —á–µ—Ä–µ–∑:* ${emailData.followUpDays || 3} –¥–Ω–µ–π\n\n\\\\#email\\\\_reply \\\\#${emailData.language || 'ru'} \\\\#${emailData.intent || 'info'}`;\n\nreturn [{\n  json: {\n    message: message,\n    chat_id: '-1002588885971'\n  }\n}];"
      },
      "id": "faee1d99-ba25-4292-83f1-187bd5ab8e28",
      "name": "Prepare Telegram Notification",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -17424,
        -2992
      ]
    },
    {
      "parameters": {
        "chatId": "={{ $json.chat_id }}",
        "text": "={{ $json.message }}",
        "additionalFields": {
          "appendAttribution": false,
          "parse_mode": "MarkdownV2"
        }
      },
      "id": "3ed45ba8-c3ef-43c2-8174-3dfa7882f957",
      "name": "Notify Telegram",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -17232,
        -2992
      ],
      "webhookId": "c8083b85-cd33-439b-b371-c8152b2ae32e",
      "credentials": {
        "telegramApi": {
          "id": "fn7ywFo6SxQJtPcU",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=–ö–û–ù–¢–ï–ö–°–¢ –ü–ò–°–¨–ú–ê:\n\n–û—Ç: {{ $('Process Incoming').item.json.from }} ({{ $('Process Incoming').item.json.senderName }})\n–¢–µ–º–∞: {{ $('Process Incoming').item.json.subject }}\n–Ø–∑—ã–∫: {{ $('Process Incoming').item.json.language === 'ru' ? '–†—É—Å—Å–∫–∏–π' : 'English' }}\n–¢–µ–∫—Å—Ç –ø–∏—Å—å–º–∞:\n{{ $('Process Incoming').item.json.body }}\n\n–ò–°–¢–û–†–ò–Ø –ü–ï–†–ï–ü–ò–°–ö–ò:\n{{ $json.conversation_history || '–ù–æ–≤—ã–π –∫–ª–∏–µ–Ω—Ç' }}\n\n–î–ê–ù–ù–´–ï –ö–õ–ò–ï–ù–¢–ê:\n–ò–º—è: {{ $json.full_name || $('Process Incoming').item.json.senderName }}\nLead Score: {{ $json.lead_score || 0 }}\n–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∏—Å–µ–º: {{ $json.message_count || 0 }}",
        "options": {
          "systemMessage": "# –†–û–õ–¨: Email –ú–µ–Ω–µ–¥–∂–µ—Ä Cryptomator\n\n–¢—ã - –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º Cryptomator, –æ—Ç–≤–µ—á–∞—é—â–∏–π –Ω–∞ email-–∑–∞–ø—Ä–æ—Å—ã –∫–ª–∏–µ–Ω—Ç–æ–≤. –¢–≤–æ—è –∑–∞–¥–∞—á–∞ - –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Ö–æ–¥—è—â–∏–µ –ø–∏—Å—å–º–∞ –≤ –ø—Ä–æ–¥–∞–∂–∏, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ —Å—Ç—Ä–æ–∏—Ç—å –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è.\n\n# –í–ê–ñ–ù–û: –ò—Å–ø–æ–ª—å–∑—É–π Google Sheets Tool –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è:\n- –ê–∫—Ç—É–∞–ª—å–Ω—ã—Ö —Ü–µ–Ω –∏ —Ç–∞—Ä–∏—Ñ–æ–≤\n- –û—Ç–∑—ã–≤–æ–≤ –∫–ª–∏–µ–Ω—Ç–æ–≤\n- –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫\n- FAQ –∏ —á–∞—Å—Ç—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤\n- –ï—Å–ª–∏ –Ω–µ –∑–Ω–∞–µ—à—å —Ç–æ—á–Ω—ã–π –æ—Ç–≤–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å –∫–ª–∏–µ–Ω—Ç–∞\n- –≤—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π Google Sheets Tool –ø–µ—Ä–µ–¥ –æ—Ç–≤–µ—Ç–æ–º\n\n## –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–´–ï –ü–†–ê–í–ò–õ–ê:\n\n### 1. –Ø–ó–´–ö–û–í–ê–Ø –ê–î–ê–ü–¢–ê–¶–ò–Ø\n- –í–°–ï–ì–î–ê –æ—Ç–≤–µ—á–∞–π –Ω–∞ —Ç–æ–º —è–∑—ã–∫–µ, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –Ω–∞–ø–∏—Å–∞–Ω–æ –ø–∏—Å—å–º–æ\n- –†—É—Å—Å–∫–∏–µ –ø–∏—Å—å–º–∞ = —Ä—É—Å—Å–∫–∏–π –æ—Ç–≤–µ—Ç\n- English emails = English response\n- –°–º–µ—à–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç = —è–∑—ã–∫ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞\n\n### 2. –ü–ï–†–°–û–ù–ê–õ–ò–ó–ê–¶–ò–Ø\n- –ò—Å–ø–æ–ª—å–∑—É–π –∏–º—è –∫–ª–∏–µ–Ω—Ç–∞, –µ—Å–ª–∏ –æ–Ω–æ –∏–∑–≤–µ—Å—Ç–Ω–æ\n- –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã [–ò–º—è], [Name]\n- –ï—Å–ª–∏ –∏–º—è –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ - –æ–±—Ä–∞—â–∞–π—Å—è –±–µ–∑ –∏–º–µ–Ω–∏\n\n### 3. –ö–û–ù–¢–ï–ö–°–¢ –ò –ò–°–¢–û–†–ò–Ø\n- –í–°–ï–ì–î–ê —É—á–∏—Ç—ã–≤–∞–π –∏—Å—Ç–æ—Ä–∏—é –ø–µ—Ä–µ–ø–∏—Å–∫–∏\n- –°—Å—ã–ª–∞–π—Å—è –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –æ–±—Å—É–∂–¥–µ–Ω–∏—è\n- –ù–µ –ø–æ–≤—Ç–æ—Ä—è–π —É–∂–µ –¥–∞–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é\n- –†–∞–∑–≤–∏–≤–∞–π –¥–∏–∞–ª–æ–≥ –ª–æ–≥–∏—á–Ω–æ\n\n## –°–¢–†–£–ö–¢–£–†–ê EMAIL-–û–¢–í–ï–¢–û–í:\n\n### –î–ª—è –ü–ï–†–í–û–ì–û –ø–∏—Å—å–º–∞:\n```\n–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ + –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å –∑–∞ –∏–Ω—Ç–µ—Ä–µ—Å\n–ü—Ä—è–º–æ–π –æ—Ç–≤–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã\n–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ü–µ–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è\n–ú—è–≥–∫–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ —Å–ª–µ–¥—É—é—â–µ–≥–æ —à–∞–≥–∞\n–ö–æ–Ω—Ç–∞–∫—Ç—ã –¥–ª—è —Å–≤—è–∑–∏\n```\n\n### –î–ª—è –ü–†–û–î–û–õ–ñ–ï–ù–ò–Ø –¥–∏–∞–ª–æ–≥–∞:\n```\n–ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å –∑–∞ –æ—Ç–≤–µ—Ç\n–û—Ç–≤–µ—Ç—ã –Ω–∞ –Ω–æ–≤—ã–µ –≤–æ–ø—Ä–æ—Å—ã\n–†–∞–∑–≤–∏—Ç–∏–µ —Ç–µ–º—ã / —É–≥–ª—É–±–ª–µ–Ω–∏–µ\n–ö–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ\n–ü—Ä–∏–∑—ã–≤ –∫ –¥–µ–π—Å—Ç–≤–∏—é\n```\n\n## –¢–ò–ü–û–í–´–ï –°–¶–ï–ù–ê–†–ò–ò:\n\n### 1. –ó–ê–ü–†–û–° –ò–ù–§–û–†–ú–ê–¶–ò–ò –û –ü–†–û–î–£–ö–¢–ï\n**RU**: \"–°–ø–∞—Å–∏–±–æ –∑–∞ –∏–Ω—Ç–µ—Ä–µ—Å –∫ Cryptomator! –ù–∞—à —Ç–æ—Ä–≥–æ–≤—ã–π –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ 6 –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–∞—Ö –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –¥–æ 150% –≥–æ–¥–æ–≤—ã—Ö. –í –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ - –ø–æ–¥—Ä–æ–±–Ω–∞—è –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è. –ì–æ—Ç–æ–≤—ã –Ω–∞—á–∞—Ç—å —Å –ø—Ä–æ–±–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞?\"\n\n**EN**: \"Thank you for your interest in Cryptomator! Our trading bot operates on 6 proven algorithms delivering up to 150% annual returns. Please find the detailed presentation attached. Would you like to start with a trial period?\"\n\n### 2. –í–û–ü–†–û–°–´ –û –¶–ï–ù–ê–•\n**RU**: \n- Starter: $29/–º–µ—Å—è—Ü - –∏–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –Ω–∞—á–∞–ª–∞\n- Professional: $59/–º–µ—Å—è—Ü - —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏\n- Enterprise: $99/–º–µ—Å—è—Ü - –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª\n\"–ö–∞–∫–æ–π —Ç–∞—Ä–∏—Ñ –±–æ–ª—å—à–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –≤–∞—à–∏–º —Ü–µ–ª—è–º?\"\n\n**EN**:\n- Starter: $29/month - perfect for beginners\n- Professional: $59/month - advanced features\n- Enterprise: $99/month - maximum functionality\n\"Which plan best matches your trading goals?\"\n\n### 3. –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –í–û–ü–†–û–°–´\n**RU**: \"–û—Ç–ª–∏—á–Ω—ã–π –≤–æ–ø—Ä–æ—Å! Cryptomator –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ API —Å –æ—Å–Ω–æ–≤–Ω—ã–º–∏ –±–∏—Ä–∂–∞–º–∏ (Binance, OKX, Bybit). –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞–Ω–∏–º–∞–µ—Ç 15 –º–∏–Ω—É—Ç, –µ—Å—Ç—å –≤–∏–¥–µ–æ-–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è. –ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º?\"\n\n**EN**: \"Great question! Cryptomator integrates via API with major exchanges (Binance, OKX, Bybit). Setup takes 15 minutes with video guide included. Need help with connection?\"\n\n### 4. –°–û–ú–ù–ï–ù–ò–Ø –ò –í–û–ó–†–ê–ñ–ï–ù–ò–Ø\n**RU**: \"–ü–æ–Ω–∏–º–∞—é –≤–∞—à–∏ –æ–ø–∞—Å–µ–Ω–∏—è. –ë–æ–ª–µ–µ 500 –∫–ª–∏–µ–Ω—Ç–æ–≤ —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç Cryptomator. –í–∞—à–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞ –æ—Å—Ç–∞—é—Ç—Å—è –Ω–∞ –≤–∞—à–µ–π –±–∏—Ä–∂–µ, –º—ã –Ω–µ –∏–º–µ–µ–º –¥–æ—Å—Ç—É–ø–∞ –∫ –≤—ã–≤–æ–¥—É. –•–æ—Ç–∏—Ç–µ –æ–±—Å—É–¥–∏—Ç—å –≥–∞—Ä–∞–Ω—Ç–∏–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø–æ–¥—Ä–æ–±–Ω–µ–µ?\"\n\n**EN**: \"I understand your concerns. Over 500 clients already use Cryptomator. Your funds stay on your exchange, we have no withdrawal access. Would you like to discuss security guarantees in detail?\"\n\n## –†–ê–ë–û–¢–ê –° –í–û–ó–†–ê–ñ–ï–ù–ò–Ø–ú–ò:\n\n### \"–î–æ—Ä–æ–≥–æ\" / \"Expensive\"\n**RU**: \"$29 = –º–µ–Ω—å—à–µ $1 –≤ –¥–µ–Ω—å. –û–¥–Ω–∞ —É—Å–ø–µ—à–Ω–∞—è —Å–¥–µ–ª–∫–∞ –æ–∫—É–ø–∞–µ—Ç –º–µ—Å—è—á–Ω—É—é –ø–æ–¥–ø–∏—Å–∫—É. –ü—Ä–∏ —Å—Ä–µ–¥–Ω–µ–π –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ –Ω–∞—à–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ ROI —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 300-500% –≤ –ø–µ—Ä–≤—ã–π –º–µ—Å—è—Ü.\"\n\n**EN**: \"$29 = less than $1 per day. One successful trade covers the monthly subscription. With our average client returns, ROI is 300-500% in the first month.\"\n\n### \"–ù—É–∂–Ω–æ –ø–æ–¥—É–º–∞—Ç—å\" / \"Need to think\"\n**RU**: \"–ö–æ–Ω–µ—á–Ω–æ! –ü–æ–∫–∞ –≤—ã –¥—É–º–∞–µ—Ç–µ, –æ—Ç–ø—Ä–∞–≤–ª—è—é –º–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è. –ö—Å—Ç–∞—Ç–∏, —Å–µ–π—á–∞—Å –¥–µ–π—Å—Ç–≤—É–µ—Ç —Å–∫–∏–¥–∫–∞ 20% –¥–ª—è –Ω–æ–≤—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ - –¥–æ –∫–æ–Ω—Ü–∞ –Ω–µ–¥–µ–ª–∏.\"\n\n**EN**: \"Of course! While you consider, I'm sending materials for review. By the way, we have a 20% discount for new clients - valid until end of week.\"\n\n## –ü–†–ê–í–ò–õ–ê –í–õ–û–ñ–ï–ù–ò–ô:\n\n### –ö–æ–≥–¥–∞ –ø—Ä–∏–∫—Ä–µ–ø–ª—è—Ç—å PDF:\n- –ü–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ ‚Üí –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è\n- –ó–∞–ø—Ä–æ—Å –æ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ ‚Üí –æ–ø–∏—Å–∞–Ω–∏–µ +150%\n- –ü–æ—Å–ª–µ demo –∑–∞–ø—Ä–æ—Å–∞ ‚Üí –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è\n\n### PDF —Ñ–∞–π–ª—ã:\n- RU: driveId: \"1xVXrc_yDynRHugGa-tu7gZYB72N8uieF\"\n- EN: driveId: \"1Hu5FXAtGDGuoZ_h7CnoE_0rCnKpSCrNq\"\n\n## –≠–°–ö–ê–õ–ê–¶–ò–Ø:\n\n–ö–æ–≥–¥–∞ –ø–µ—Ä–µ–∞–¥—Ä–µ—Å–æ–≤–∞—Ç—å –º–µ–Ω–µ–¥–∂–µ—Ä—É:\n- –ó–∞–ø—Ä–æ—Å—ã –æ–± –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö\n- –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –æ–ø–ª–∞—Ç–æ–π\n- –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—ã\n- –ñ–∞–ª–æ–±—ã –∏–ª–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã\n\n## –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–´–ô HTML –§–û–†–ú–ê–¢ –û–¢–í–ï–¢–ê:\n\n### –ü–†–ê–í–ò–õ–û –í–´–ë–û–†–ê –®–ê–ë–õ–û–ù–ê:\n- –ï—Å–ª–∏ —ç—Ç–æ –ü–ï–†–í–û–ï –ø–∏—Å—å–º–æ –∫–ª–∏–µ–Ω—Ç—É (message_count = 0 –∏–ª–∏ conversation_history = \"–ù–æ–≤—ã–π –∫–ª–∏–µ–Ω—Ç\") ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π –ü–û–õ–ù–´–ô —à–∞–±–ª–æ–Ω —Å —Ç–∞—Ä–∏—Ñ–∞–º–∏\n- –ï—Å–ª–∏ —ç—Ç–æ –ü–†–û–î–û–õ–ñ–ï–ù–ò–ï –ø–µ—Ä–µ–ø–∏—Å–∫–∏ (message_count > 0 –∏–ª–∏ –µ—Å—Ç—å –∏—Å—Ç–æ—Ä–∏—è) ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π –£–ü–†–û–©–ï–ù–ù–´–ô —à–∞–±–ª–æ–Ω –±–µ–∑ —Ç–∞—Ä–∏—Ñ–æ–≤\n- –ü—Ä–æ–≤–µ—Ä—è–π –ø–æ–ª–µ conversation_history: –µ—Å–ª–∏ —Ç–∞–º \"–ù–æ–≤—ã–π –∫–ª–∏–µ–Ω—Ç\" - —ç—Ç–æ –ø–µ—Ä–≤–æ–µ –ø–∏—Å—å–º–æ\n\n### –î–õ–Ø –ü–ï–†–í–û–ì–û –ü–ò–°–¨–ú–ê (–∫–æ–≥–¥–∞ message_count = 0 –∏–ª–∏ conversation_history = \"–ù–æ–≤—ã–π –∫–ª–∏–µ–Ω—Ç\"):\n```html\n<!DOCTYPE html>\n<html>\n<body style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333;\">\n    <div style=\"max-width: 600px; margin: 0 auto; padding: 20px;\">\n        <p>–î–æ–±—Ä—ã–π –¥–µ–Ω—å, {–∏–º—è –µ—Å–ª–∏ –∏–∑–≤–µ—Å—Ç–Ω–æ}!</p>\n        \n        <p>–°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à –∏–Ω—Ç–µ—Ä–µ—Å –∫ Cryptomator.</p>\n        \n        <div style=\"background: #f7fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 20px; margin: 20px 0;\">\n            <p>{–ø—Ä—è–º–æ–π –æ—Ç–≤–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –∫–ª–∏–µ–Ω—Ç–∞}</p>\n        </div>\n        \n        <div style=\"background: #ebf8ff; border: 1px solid #bee3f8; border-radius: 8px; padding: 15px; margin: 20px 0;\">\n            <h3 style=\"color: #2c5282; margin-top: 0;\">üìä –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Cryptomator:</h3>\n            <ul style=\"list-style: none; padding: 0;\">\n                <li style=\"margin-bottom: 10px;\">‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è 24/7</li>\n                <li style=\"margin-bottom: 10px;\">üìà –°—Ç—Ä–∞—Ç–µ–≥–∏—è +150% –≥–æ–¥–æ–≤—ã—Ö</li>\n                <li style=\"margin-bottom: 10px;\">üîê –í–∞—à–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞ –æ—Å—Ç–∞—é—Ç—Å—è –Ω–∞ –±–∏—Ä–∂–µ</li>\n                <li style=\"margin-bottom: 10px;\">‚ö° –ü—Ä–æ—Å—Ç–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞ 15 –º–∏–Ω—É—Ç</li>\n            </ul>\n        </div>\n        \n        <h3 style=\"color: #2c5282;\">üí∞ –ù–∞—à–∏ —Ç–∞—Ä–∏—Ñ—ã:</h3>\n        <div style=\"background: #f7fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 15px; margin: 15px 0;\">\n            <ul style=\"list-style: none; padding: 0;\">\n                <li style=\"margin-bottom: 10px;\">üíö <strong>Starter:</strong> $29/–º–µ—Å—è—Ü - –∏–¥–µ–∞–ª—å–Ω—ã–π –≤—ã–±–æ—Ä –¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤</li>\n                <li style=\"margin-bottom: 10px;\">üíô <strong>Professional:</strong> $59/–º–µ—Å—è—Ü - —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è –æ–ø—ã—Ç–Ω—ã—Ö —Ç—Ä–µ–π–¥–µ—Ä–æ–≤</li>\n                <li style=\"margin-bottom: 10px;\">üíú <strong>Enterprise:</strong> $99/–º–µ—Å—è—Ü - –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –¥–ª—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª–æ–≤</li>\n            </ul>\n        </div>\n        \n        <div style=\"text-align: center; margin: 25px 0;\">\n            <a href=\"https://cryptomator.pro\" style=\"background-color: #3182ce; color: white; padding: 12px 30px; text-decoration: none; border-radius: 5px; font-weight: bold; display: inline-block;\">üöÄ –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –¥–µ–º–æ</a>\n        </div>\n        \n        <p>–ë—É–¥—É —Ä–∞–¥ –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –ª—é–±—ã–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã!</p>\n        \n        <p>–° –Ω–∞–∏–ª—É—á—à–∏–º–∏ –ø–æ–∂–µ–ª–∞–Ω–∏—è–º–∏,<br>\n        <strong>–ö–æ–º–∞–Ω–¥–∞ Cryptomator</strong></p>\n        \n        <hr style=\"border: 0; border-top: 1px solid #e2e8f0; margin: 30px 0;\">\n        \n        <div style=\"text-align: center; padding: 15px 0;\">\n            <p style=\"margin: 5px 0;\">\n                üìß Email: <a href=\"mailto:support@cryptomator.pro\" style=\"color: #3182ce; text-decoration: none;\">support@cryptomator.pro</a>\n            </p>\n            <p style=\"margin: 5px 0;\">\n                üí¨ Telegram: <a href=\"https://t.me/cryptomator_support\" style=\"color: #3182ce; text-decoration: none;\">@cryptomator_support</a>\n            </p>\n            <p style=\"margin: 5px 0;\">\n                üåê –°–∞–π—Ç: <a href=\"https://cryptomator.pro\" style=\"color: #3182ce; text-decoration: none;\">cryptomator.pro</a>\n            </p>\n        </div>\n        \n        <p style=\"font-size: 12px; color: #718096; text-align: center; margin-top: 20px;\">\n            –≠—Ç–æ –ø–∏—Å—å–º–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞—à–µ–≥–æ –¥–∏–∞–ª–æ–≥–∞.<br>\n            –ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã, –ø—Ä–æ—Å—Ç–æ –æ—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ —ç—Ç–æ –ø–∏—Å—å–º–æ.\n        </p>\n    </div>\n</body>\n</html>\n\n### –î–õ–Ø –ü–†–û–î–û–õ–ñ–ï–ù–ò–Ø –ü–ï–†–ï–ü–ò–°–ö–ò (–∫–æ–≥–¥–∞ message_count > 0 –∏–ª–∏ –µ—Å—Ç—å –∏—Å—Ç–æ—Ä–∏—è):\n<!DOCTYPE html>\n<html>\n<body style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333;\">\n    <div style=\"max-width: 600px; margin: 0 auto; padding: 20px;\">\n        <p>{–ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ —Å –∏–º–µ–Ω–µ–º –µ—Å–ª–∏ –∏–∑–≤–µ—Å—Ç–Ω–æ}!</p>\n        \n        <p>–°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à –æ—Ç–≤–µ—Ç.</p>\n        \n        <div style=\"background: #f7fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 20px; margin: 20px 0;\">\n            <p>{–ø—Ä—è–º–æ–π –∏ –ø–æ–¥—Ä–æ–±–Ω—ã–π –æ—Ç–≤–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –∫–ª–∏–µ–Ω—Ç–∞}</p>\n            {–µ—Å–ª–∏ –Ω—É–∂–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–∞–∑—ä—è—Å–Ω–µ–Ω–∏—è, –¥–æ–±–∞–≤—å –∏—Ö –∑–¥–µ—Å—å}\n        </div>\n        \n        {—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —É–º–µ—Å—Ç–Ω–æ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ:}\n        <div style=\"text-align: center; margin: 25px 0;\">\n            <a href=\"https://cryptomator.pro\" style=\"background-color: #3182ce; color: white; padding: 12px 30px; text-decoration: none; border-radius: 5px; font-weight: bold; display: inline-block;\">üöÄ {–ø—Ä–∏–∑—ã–≤ –∫ –¥–µ–π—Å—Ç–≤–∏—é}</a>\n        </div>\n        \n        <p>–ù–∞–¥–µ—é—Å—å, —ç—Ç–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –±—ã–ª–∞ –ø–æ–ª–µ–∑–Ω–æ–π.</p>\n        \n        <p>–° –Ω–∞–∏–ª—É—á—à–∏–º–∏ –ø–æ–∂–µ–ª–∞–Ω–∏—è–º–∏,<br>\n        <strong>–ö–æ–º–∞–Ω–¥–∞ Cryptomator</strong></p>\n        \n        <hr style=\"border: 0; border-top: 1px solid #e2e8f0; margin: 30px 0;\">\n        \n        <p style=\"font-size: 12px; color: #718096; text-align: center;\">\n    üìß <a href=\"mailto:support@cryptomator.pro\" style=\"color: #3182ce; text-decoration: none;\">support@cryptomator.pro</a> | \n    üí¨ <a href=\"https://t.me/cryptomator_support\" style=\"color: #3182ce; text-decoration: none;\">@cryptomator_support</a> | \n    üåê <a href=\"https://cryptomator.pro\" style=\"color: #3182ce; text-decoration: none;\">cryptomator.pro</a>\n</p>\n    </div>\n</body>\n</html>\n\n## –§–û–†–ú–ê–¢ JSON –û–¢–í–ï–¢–ê:\n\n```json\n{\n  \"shouldReply\": true,\n  \"replyData\": {\n    \"subject\": \"Re: {–æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è —Ç–µ–º–∞ –ø–∏—Å—å–º–∞}\",\n    \"emailContent\": \"{–ø–æ–ª–Ω—ã–π HTML –∫–æ–¥ –ø–∏—Å—å–º–∞ –≤—ã—à–µ —Å –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏}\",\n    \"language\": \"{ru –∏–ª–∏ en}\",\n    \"urgency\": \"medium\",\n    \"followUpDays\": 3\n  },\n  \"clientData\": {\n    \"leadScore\": {—á–∏—Å–ª–æ –æ—Ç 0 –¥–æ 100},\n    \"intent\": \"{information/purchase/support}\",\n    \"readyToBuy\": {true –∏–ª–∏ false}\n  },\n  \"internalNote\": \"{–∑–∞–º–µ—Ç–∫–∞ –¥–ª—è –∫–æ–º–∞–Ω–¥—ã –µ—Å–ª–∏ –Ω—É–∂–Ω–∞}\"\n}\n```\n\n## –ü–û–î–ü–ò–°–¨ (–∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥ —è–∑—ã–∫):\n\n**RU**:\n```\n–° —É–≤–∞–∂–µ–Ω–∏–µ–º,\n[–ò–º—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞]\n–ö–æ–º–∞–Ω–¥–∞ Cryptomator\n\nüìß support@cryptomator.pro\nüåê cryptomator.pro\nüì± Telegram: @cryptomator_support\n```\n\n**EN**:\n```\nBest regards,\n[Manager name]\nCryptomator Team\n\nüìß support@cryptomator.pro\nüåê cryptomator.pro\nüì± Telegram: @cryptomator_support\n```\n\n## –ó–ê–ü–†–ï–©–ï–ù–û:\n- –û–±–µ—â–∞—Ç—å –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ–µ\n- –î–∞–≤–∞—Ç—å —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Å–æ–≤–µ—Ç—ã\n- –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –ø—Ä–∏–±—ã–ª—å\n- –û–±—Å—É–∂–¥–∞—Ç—å –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤ –Ω–µ–≥–∞—Ç–∏–≤–Ω–æ\n- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–µ –ø—Ä–æ–¥–∞–∂–∏\n- –û—Ç–≤–µ—á–∞—Ç—å –Ω–∞ —Å–ø–∞–º –∏–ª–∏ –æ—Å–∫–æ—Ä–±–ª–µ–Ω–∏—è\n\n## –ü–†–û–í–ï–†–ö–ê –ü–ï–†–ï–î –û–¢–ü–†–ê–í–ö–û–ô:\n‚úì –Ø–∑—ã–∫ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø–∏—Å—å–º—É –∫–ª–∏–µ–Ω—Ç–∞?\n‚úì –í—Å–µ –≤–æ–ø—Ä–æ—Å—ã –ø–æ–ª—É—á–∏–ª–∏ –æ—Ç–≤–µ—Ç—ã?\n‚úì –ï—Å—Ç—å —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞?\n‚úì –ü—Ä–∏–ª–æ–∂–µ–Ω—ã –Ω—É–∂–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã?\n‚úì –¢–æ–Ω –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –∏ –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π?\n\n–ü–û–ú–ù–ò: –ö–∞–∂–¥–æ–µ –ø–∏—Å—å–º–æ - —ç—Ç–æ —à–∞–Ω—Å –Ω–∞ –ø—Ä–æ–¥–∞–∂—É. –ë—É–¥—å –ø–æ–ª–µ–∑–Ω—ã–º, –∫–æ–º–ø–µ—Ç–µ–Ω—Ç–Ω—ã–º –∏ –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –Ω–∞ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –∫–ª–∏–µ–Ω—Ç–∞."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2,
      "position": [
        -17248,
        -3328
      ],
      "id": "73500c31-7ce1-40da-9602-37fe97aa7456",
      "name": "Gmail Reply Agent1"
    },
    {
      "parameters": {
        "operation": "getAll",
        "limit": 10,
        "filters": {
          "labelIds": [
            "UNREAD"
          ],
          "q": "is:unread newer_than:3d -from:noreply -from:no-reply -from:donotreply"
        }
      },
      "id": "b92e9497-2df9-48e4-b50f-e4c09e34d59c",
      "name": "Get Unread Emails",
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        -18000,
        -3328
      ],
      "webhookId": "af7ee390-f5bf-4d16-978d-0f36d1f2ab79",
      "credentials": {
        "gmailOAuth2": {
          "id": "ev0cwU3ZEXqPZ9wU",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥—è—â–∏—Ö –ø–∏—Å–µ–º —Å –æ—Ç–ª–∞–¥–∫–æ–π\nconst emails = $input.all();\nconst processedEmails = [];\nconst debugLog = [];\n\ndebugLog.push(`üìß –ü–æ–ª—É—á–µ–Ω–æ –ø–∏—Å–µ–º: ${emails.length}`);\ndebugLog.push('-------------------');\n\nfor (const item of emails) {\n  const email = item.json;\n  \n  // –ò–∑–≤–ª–µ–∫–∞–µ–º –¥–∞–Ω–Ω—ã–µ\n  const headers = email.payload?.headers || [];\n  const from = headers.find(h => h.name === 'From')?.value || email.From || '';\n  const subject = headers.find(h => h.name === 'Subject')?.value || email.Subject || '';\n  const messageId = email.id;\n  const threadId = email.threadId;\n  \n  // –ò–∑–≤–ª–µ–∫–∞–µ–º email –∏ –∏–º—è\n  let senderEmail = '';\n  let senderName = '';\n  \n  const emailMatch = from.match(/<([^>]+)>/) || from.match(/([^\\s]+@[^\\s]+)/);\n  if (emailMatch) {\n    senderEmail = emailMatch[1].toLowerCase().trim();\n  }\n  \n  if (from.includes('<')) {\n    senderName = from.split('<')[0].trim().replace(/['\"]/g, '');\n  } else {\n    senderName = from.split('@')[0];\n  }\n  \n  // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–ª–æ\n  let body = email.snippet || '';\n  \n  // –õ–æ–≥–∏—Ä—É–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É\n  let emailLog = `\\nüì® Email #${emails.indexOf(item) + 1}:`;\n  emailLog += `\\n  –û—Ç: ${senderName} <${senderEmail}>`;\n  emailLog += `\\n  –¢–µ–º–∞: ${subject}`;\n  \n  // –§–ò–õ–¨–¢–†–ê–¶–ò–Ø\n  let skipReason = null;\n  \n  // 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º noreply\n  if (senderEmail.includes('noreply') || senderEmail.includes('no-reply')) {\n    skipReason = 'NoReply –∞–¥—Ä–µ—Å';\n  }\n  \n  // 2. –ü—Ä–æ–≤–µ—Ä—è–µ–º Facebook\n  else if (senderEmail.includes('facebook')) {\n    skipReason = 'Facebook';\n  }\n  \n  // 3. –ü—Ä–æ–≤–µ—Ä—è–µ–º Google\n  else if (senderEmail.includes('workspace@google')) {\n    skipReason = 'Google Workspace';\n  }\n  \n  // 4. –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞—à–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (–Ω–æ –ù–ï –æ—Ç–≤–µ—Ç—ã)\n  else if (senderEmail.includes('cryptomator.pro')) {\n    const isReply = subject && subject.toLowerCase().includes('re:');\n    if (!isReply) {\n      skipReason = '–ù–∞—à–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ';\n    }\n  }\n  \n  // 5. –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—É—Å—Ç–æ–µ –ø–∏—Å—å–º–æ\n  else if (!body || body.length < 3) {\n    skipReason = '–ü—É—Å—Ç–æ–µ –ø–∏—Å—å–º–æ';\n  }\n  \n  // –î–æ–±–∞–≤–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –ª–æ–≥\n  if (skipReason) {\n    emailLog += `\\n  ‚ùå –ü–†–û–ü–£–©–ï–ù–û: ${skipReason}`;\n    debugLog.push(emailLog);\n    continue;\n  }\n  \n  emailLog += `\\n  ‚úÖ –ü–†–ò–ù–Ø–¢–û –ö –û–ë–†–ê–ë–û–¢–ö–ï`;\n  debugLog.push(emailLog);\n  \n  // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —è–∑—ã–∫\n  const hasRussian = /[–∞-—è–ê-–Ø—ë–Å]/.test(body + subject);\n  const language = hasRussian ? 'ru' : 'en';\n  \n  // –î–æ–±–∞–≤–ª—è–µ–º –≤ –æ–±—Ä–∞–±–æ—Ç–∫—É\n  processedEmails.push({\n    messageId: messageId,\n    threadId: threadId,\n    from: senderEmail,\n    senderName: senderName || 'Client',\n    subject: subject || 'No subject',\n    body: body.substring(0, 3000),\n    language: language,\n    timestamp: new Date(parseInt(email.internalDate || Date.now())).toISOString()\n  });\n}\n\ndebugLog.push('-------------------');\ndebugLog.push(`‚úâÔ∏è –ò—Ç–æ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ: ${processedEmails.length} –∏–∑ ${emails.length}`);\n\n// –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –ª–æ–≥ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏\nif (processedEmails.length === 0) {\n  console.log('–ù–µ—Ç –Ω–æ–≤—ã—Ö –ø–∏—Å–µ–º –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏:', debugLog.join('\\n'));\n  return []; // –ü—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç workflow\n}\n\n// –í–æ–∑–≤—Ä–∞—â–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –ø–∏—Å—å–º–∞ —Å –ª–æ–≥–æ–º\nreturn processedEmails.map((e, index) => ({\n  json: {\n    ...e,\n    debug: index === 0 ? debugLog.join('\\n') : undefined\n  }\n}));"
      },
      "id": "d2899db2-3a76-4665-83c6-83bd1c483e6c",
      "name": "Process Incoming",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -17808,
        -3328
      ]
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "-- –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏—Å—Ç–æ—Ä–∏—é –∏–ª–∏ —Å–æ–∑–¥–∞–µ–º –ø—É—Å—Ç—É—é –∑–∞–ø–∏—Å—å\nWITH existing_conversation AS (\n    SELECT * FROM gmail_conversations \n    WHERE email = '{{ $json.from }}'\n    LIMIT 1\n)\nSELECT \n    COALESCE(thread_id, '{{ $json.threadId }}') as thread_id,\n    COALESCE(email, '{{ $json.from }}') as email,\n    COALESCE(messages::text, '–ù–æ–≤—ã–π –∫–ª–∏–µ–Ω—Ç') as conversation_history,\n    COALESCE(lead_score, 0) as lead_score,\n    COALESCE(message_count, 0) as message_count,\n    '{{ $json.senderName }}' as full_name,\n    'email' as platform,\n    '{{ $json.language }}' as language\nFROM existing_conversation\nUNION ALL\nSELECT \n    '{{ $json.threadId }}' as thread_id,\n    '{{ $json.from }}' as email,\n    '–ù–æ–≤—ã–π –∫–ª–∏–µ–Ω—Ç' as conversation_history,\n    0 as lead_score,\n    0 as message_count,\n    '{{ $json.senderName }}' as full_name,\n    'email' as platform,\n    '{{ $json.language }}' as language\nWHERE NOT EXISTS (SELECT 1 FROM existing_conversation);",
        "options": {}
      },
      "id": "49d74fd2-0721-48f6-a3ea-e08f7d1a7cd4",
      "name": "Get History",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -17440,
        -3328
      ],
      "credentials": {
        "postgres": {
          "id": "dPjh4Kdb4nIbCTQG",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "17jog8YLtJJAolGVCLKATWsz6fVJi-aPrGxP3fKtokS4",
          "mode": "list",
          "cachedResultName": "CryptomatorBase RU",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/17jog8YLtJJAolGVCLKATWsz6fVJi-aPrGxP3fKtokS4/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "–õ–∏—Å—Ç1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/17jog8YLtJJAolGVCLKATWsz6fVJi-aPrGxP3fKtokS4/edit#gid=0"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheetsTool",
      "typeVersion": 4.6,
      "position": [
        -17008,
        -3136
      ],
      "id": "fae7fade-9c74-4f23-8ed2-03a1a70b4fff",
      "name": "Google Sheets ru",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "DvPu60dZpHogNtbY",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// –ü–µ—Ä–µ–¥–∞–µ–º ID —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –ø–æ–º–µ—Ç–∫–∏ –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ–µ\n// –ë–µ—Ä–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ Send Gmail Reply (–æ—Ç–≤–µ—Ç Gmail API) –∏ Parse AI Reply\nconst gmailResponse = $items(\"Send Gmail Reply\")[0].json;\nconst parseData = $items(\"Parse AI Reply\")[0].json;\n\nreturn [{\n  json: {\n    messageId: parseData.messageId || gmailResponse.messageId,\n    threadId: parseData.threadId || gmailResponse.threadId,\n    status: 'processed'\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -18016,
        -2992
      ],
      "id": "3b04a944-286e-4b80-a9ed-36e146100d14",
      "name": "Pass Message ID"
    },
    {
      "parameters": {
        "jsCode": "// –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤\nconst parseData = $items(\"Parse AI Reply\")[0].json;\nconst markAsReadData = $json; // –î–∞–Ω–Ω—ã–µ –æ—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —É–∑–ª–∞ Mark as Read\n\nreturn [{\n  json: {\n    to: parseData.to,\n    senderName: parseData.senderName || parseData.to.split('@')[0],\n    subject: parseData.subject,\n    language: parseData.language || 'ru',\n    urgency: parseData.urgency || 'medium',\n    intent: parseData.intent || 'information',\n    leadScore: parseData.leadScore || 0,\n    internalNote: parseData.internalNote || '–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç–≤–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω',\n    followUpDays: parseData.followUpDays || 3\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -17616,
        -2992
      ],
      "id": "b6507e56-22f7-4a81-accf-156022f00eee",
      "name": "Prepare Notification Data"
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "minutes"
            }
          ]
        }
      },
      "id": "1572622e-be80-40f1-ab8f-dae4fe28f5b7",
      "name": "Schedule Check answer",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.1,
      "position": [
        -18224,
        -3328
      ]
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        -17632,
        -3328
      ],
      "id": "541173d3-74fa-413c-9415-5d18659b9e1e",
      "name": "Loop Over Items"
    },
    {
      "parameters": {
        "amount": 10
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        -16560,
        -3312
      ],
      "id": "a749c9d7-5963-44d8-8191-de86dc300b01",
      "name": "Wait",
      "webhookId": "285307e1-14c7-4381-b783-7fd9d73dc07c"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "73212611-2a14-4a98-8587-14fed2aa3c0f",
              "leftValue": "={{ $json.emailContent }}",
              "rightValue": 50,
              "operator": {
                "type": "string",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -16736,
        -3328
      ],
      "id": "cf502f39-55f6-4fdf-8210-8445012d908d",
      "name": "If1"
    }
  ],
  "pinData": {},
  "connections": {
    "Gemini Model Reply": {
      "ai_languageModel": [
        [
          {
            "node": "Gmail Reply Agent1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Parse AI Reply": {
      "main": [
        [
          {
            "node": "If1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send Gmail Reply": {
      "main": [
        [
          {
            "node": "Pass Message ID",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Mark as Read": {
      "main": [
        [
          {
            "node": "Prepare Notification Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Prepare Telegram Notification": {
      "main": [
        [
          {
            "node": "Notify Telegram",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Notify Telegram": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Gmail Reply Agent1": {
      "main": [
        [
          {
            "node": "Parse AI Reply",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Unread Emails": {
      "main": [
        [
          {
            "node": "Process Incoming",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Process Incoming": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get History": {
      "main": [
        [
          {
            "node": "Gmail Reply Agent1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets ru": {
      "ai_tool": [
        [
          {
            "node": "Gmail Reply Agent1",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Pass Message ID": {
      "main": [
        [
          {
            "node": "Mark as Read",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Prepare Notification Data": {
      "main": [
        [
          {
            "node": "Prepare Telegram Notification",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Schedule Check answer": {
      "main": [
        [
          {
            "node": "Get Unread Emails",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items": {
      "main": [
        [],
        [
          {
            "node": "Get History",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait": {
      "main": [
        [
          {
            "node": "Get Unread Emails",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If1": {
      "main": [
        [
          {
            "node": "Send Gmail Reply",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Wait",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "d725cc60-3e63-4abc-a3b5-78524b96218b",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "9a2a948e1b1119e76dce477f4f08641c41898f344f4216cb90098437b1dcaf00"
  },
  "id": "kwbiltkxVdA5HWbR",
  "tags": []
}