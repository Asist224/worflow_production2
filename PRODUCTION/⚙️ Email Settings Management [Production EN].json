{
  "name": "âš™ï¸ Email Settings Management [Production EN]",
  "nodes": [
    {
      "parameters": {
        "content": "## âš™ï¸ Email Settings Management - Settings Management\n\n### Description\nThis workflow manages email system settings:\n- Auto-analysis of email correspondence\n- Cleanup and archiving of old records\n- Automatic tasks scheduling\n\n---\n\n### ğŸ”§ Setup\n\n1. **Open the `âš™ï¸ CONFIG` node** and configure:\n   - `api_key` â€” your API key to protect the endpoint\n   - `rate_limit_window_ms` â€” rate limiting window (ms)\n   - `rate_limit_max_requests` â€” max requests in window\n   - `batch_analysis_webhook` â€” URL for batch analysis trigger\n   - PostgreSQL table names\n\n2. **Connect PostgreSQL** credential to DB nodes\n\n3. **Configure schedule** in Schedule Trigger nodes\n\n4. **Activate the workflow**\n\n---\n\n### ğŸ“¡ API Endpoints\n\n#### 1. Get Auto Analysis Settings\n**GET** `/webhook/email-auto-analysis-settings`\n\n#### 2. Get Cleanup Settings\n**GET** `/webhook/email-cleanup-settings`\n\n#### 3. Update Cleanup Settings\n**POST** `/webhook/update-email-cleanup-settings`\n\n**Headers for all:**\n```\nx-api-key: your_api_key\n```\n\n---\n\n### â° Automatic Tasks\n\n- **Batch Analysis** â€” every hour\n- **Cleanup** â€” daily at 3:00"
      },
      "id": "sticky-note-instructions",
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -550,
        -300
      ]
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "api-key",
              "name": "api_key",
              "value": "24fs-$r4d-defd-77ds-7eds",
              "type": "string"
            },
            {
              "id": "rate-window",
              "name": "rate_limit_window_ms",
              "value": 60000,
              "type": "number"
            },
            {
              "id": "rate-max",
              "name": "rate_limit_max_requests",
              "value": 60,
              "type": "number"
            },
            {
              "id": "batch-webhook",
              "name": "batch_analysis_webhook",
              "value": "https://your-n8n-domain.com/webhook/analyze-email-dialog",
              "type": "string"
            },
            {
              "id": "table-monitoring",
              "name": "table_email_monitoring",
              "value": "email_monitoring",
              "type": "string"
            },
            {
              "id": "table-archive",
              "name": "table_email_monitoring_archive",
              "value": "email_monitoring_archive",
              "type": "string"
            },
            {
              "id": "table-log",
              "name": "table_email_processing_log",
              "value": "email_processing_log",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "id": "config-node",
      "name": "âš™ï¸ CONFIG",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -350,
        200
      ]
    },
    {
      "parameters": {
        "path": "email-auto-analysis-settings",
        "responseMode": "responseNode",
        "options": {
          "allowedOrigins": "*"
        }
      },
      "id": "7deab63f-17ed-43e5-8e66-131f18c115d2",
      "name": "ğŸŒ Webhook: Auto Settings",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        -144,
        -80
      ],
      "webhookId": "email-auto-analysis-settings-webhook"
    },
    {
      "parameters": {
        "jsCode": "// ============================================\n// ğŸ” UNIVERSAL PROTECTION: API KEY + RATE LIMITING\n// ============================================\n\n// Get settings from CONFIG\nconst config = $('âš™ï¸ CONFIG').first().json;\nconst API_KEY = config.api_key;\nconst RATE_LIMIT_WINDOW_MS = config.rate_limit_window_ms;\nconst RATE_LIMIT_MAX_REQUESTS = config.rate_limit_max_requests;\n\nconst inputData = $('ğŸŒ Webhook: Auto Settings').item.json;\nconst body = inputData.body || {};\nconst headers = inputData.headers || {};\nconst query = inputData.query || {};\nconst clientIP = headers['x-real-ip'] || headers['x-forwarded-for'] || headers['cf-connecting-ip'] || 'unknown';\nconst now = Date.now();\n\n// RATE LIMITING\nconst staticData = $getWorkflowStaticData('global');\nif (!staticData.rateLimits) { staticData.rateLimits = {}; }\nfor (const ip in staticData.rateLimits) {\n  if (now - staticData.rateLimits[ip].firstRequest > RATE_LIMIT_WINDOW_MS) {\n    delete staticData.rateLimits[ip];\n  }\n}\nif (!staticData.rateLimits[clientIP]) {\n  staticData.rateLimits[clientIP] = { count: 1, firstRequest: now };\n} else {\n  staticData.rateLimits[clientIP].count++;\n  if (staticData.rateLimits[clientIP].count > RATE_LIMIT_MAX_REQUESTS) {\n    return [{ json: { ...inputData, authorized: false, error: { success: false, error: 'Too many requests', details: `Limit: ${RATE_LIMIT_MAX_REQUESTS} requests per minute`, status: 429, retryAfter: Math.ceil((staticData.rateLimits[clientIP].firstRequest + RATE_LIMIT_WINDOW_MS - now) / 1000) } } }];\n  }\n}\n\n// API KEY CHECK\nconst providedKey = headers['x-api-key'] || body.apiKey || query.apiKey || '';\nif (!providedKey) {\n  return [{ json: { ...inputData, authorized: false, error: { success: false, error: 'API key not provided', status: 401 } } }];\n}\nif (providedKey !== API_KEY) {\n  return [{ json: { ...inputData, authorized: false, error: { success: false, error: 'Invalid API key', status: 401 } } }];\n}\n\nreturn [{ json: { ...inputData, authorized: true } }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        16,
        -80
      ],
      "id": "security-auto",
      "name": "ğŸ” Security (Auto)"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 2
          },
          "conditions": [
            {
              "id": "auth-condition",
              "leftValue": "={{ $json.authorized }}",
              "rightValue": "",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        176,
        -80
      ],
      "id": "auth-auto",
      "name": "ğŸ”€ Auth (Auto)"
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ $json.error }}",
        "options": {
          "responseCode": "={{ $json.error.status }}"
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        352,
        16
      ],
      "id": "error-auto",
      "name": "âŒ Error (Auto)"
    },
    {
      "parameters": {
        "jsCode": "// Get current auto-analysis settings for email\n// In a real system this should be stored in DB\nconst settings = {\n  autoAnalysis: {\n    enabled: true,\n    frequency: 'hourly', // hourly, daily, weekly\n    triggerOn: {\n      newEmails: true,\n      unreadEmails: true,\n      highPriorityEmails: true,\n      afterMessages: 3 // Analyze after N messages\n    },\n    filters: {\n      minLeadScore: 30,\n      languages: ['ru', 'en'],\n      excludeDomains: ['noreply', 'no-reply', 'donotreply']\n    },\n    schedule: {\n      startTime: '09:00',\n      endTime: '18:00',\n      workDays: [1, 2, 3, 4, 5] // Mon-Fri\n    }\n  },\n  contactExtraction: {\n    enabled: true,\n    autoExtract: true,\n    extractOn: {\n      newEmails: true,\n      afterAnalysis: true\n    }\n  },\n  notifications: {\n    enabled: true,\n    channels: {\n      telegram: true,\n      email: false,\n      webhook: false\n    },\n    notifyOn: {\n      highLeadScore: 80,\n      urgentEmails: true,\n      noReplyTimeout: 24 // hours\n    }\n  }\n};\n\nreturn [{json: settings}];"
      },
      "id": "ac3ca0dd-28bc-436b-ac4a-d982e1c5e277",
      "name": "ğŸ“‹ Get Auto Settings",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        352,
        -144
      ]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ $json }}",
        "options": {}
      },
      "id": "49daa698-a05f-4d66-93be-3e09d48468d2",
      "name": "ğŸ“¤ Send Auto Settings",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        544,
        -144
      ]
    },
    {
      "parameters": {
        "path": "email-cleanup-settings",
        "responseMode": "responseNode",
        "options": {
          "allowedOrigins": "*"
        }
      },
      "id": "ccebfae3-6892-40ee-b1e7-748da6da788a",
      "name": "ğŸŒ Webhook: Cleanup Settings",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        -144,
        200
      ],
      "webhookId": "email-cleanup-settings-webhook"
    },
    {
      "parameters": {
        "jsCode": "// ============================================\n// ğŸ” UNIVERSAL PROTECTION: API KEY + RATE LIMITING\n// ============================================\n\n// Get settings from CONFIG\nconst config = $('âš™ï¸ CONFIG').first().json;\nconst API_KEY = config.api_key;\nconst RATE_LIMIT_WINDOW_MS = config.rate_limit_window_ms;\nconst RATE_LIMIT_MAX_REQUESTS = config.rate_limit_max_requests;\n\nconst inputData = $('ğŸŒ Webhook: Cleanup Settings').item.json;\nconst body = inputData.body || {};\nconst headers = inputData.headers || {};\nconst query = inputData.query || {};\nconst clientIP = headers['x-real-ip'] || headers['x-forwarded-for'] || headers['cf-connecting-ip'] || 'unknown';\nconst now = Date.now();\n\n// RATE LIMITING\nconst staticData = $getWorkflowStaticData('global');\nif (!staticData.rateLimits) { staticData.rateLimits = {}; }\nfor (const ip in staticData.rateLimits) {\n  if (now - staticData.rateLimits[ip].firstRequest > RATE_LIMIT_WINDOW_MS) {\n    delete staticData.rateLimits[ip];\n  }\n}\nif (!staticData.rateLimits[clientIP]) {\n  staticData.rateLimits[clientIP] = { count: 1, firstRequest: now };\n} else {\n  staticData.rateLimits[clientIP].count++;\n  if (staticData.rateLimits[clientIP].count > RATE_LIMIT_MAX_REQUESTS) {\n    return [{ json: { ...inputData, authorized: false, error: { success: false, error: 'Too many requests', details: `Limit: ${RATE_LIMIT_MAX_REQUESTS} requests per minute`, status: 429, retryAfter: Math.ceil((staticData.rateLimits[clientIP].firstRequest + RATE_LIMIT_WINDOW_MS - now) / 1000) } } }];\n  }\n}\n\n// API KEY CHECK\nconst providedKey = headers['x-api-key'] || body.apiKey || query.apiKey || '';\nif (!providedKey) {\n  return [{ json: { ...inputData, authorized: false, error: { success: false, error: 'API key not provided', status: 401 } } }];\n}\nif (providedKey !== API_KEY) {\n  return [{ json: { ...inputData, authorized: false, error: { success: false, error: 'Invalid API key', status: 401 } } }];\n}\n\nreturn [{ json: { ...inputData, authorized: true } }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        16,
        200
      ],
      "id": "security-cleanup",
      "name": "ğŸ” Security (Cleanup)"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 2
          },
          "conditions": [
            {
              "id": "auth-condition",
              "leftValue": "={{ $json.authorized }}",
              "rightValue": "",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        176,
        200
      ],
      "id": "auth-cleanup",
      "name": "ğŸ”€ Auth (Cleanup)"
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ $json.error }}",
        "options": {
          "responseCode": "={{ $json.error.status }}"
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        352,
        296
      ],
      "id": "error-cleanup",
      "name": "âŒ Error (Cleanup)"
    },
    {
      "parameters": {
        "jsCode": "// Get cleanup settings for email\nconst cleanupSettings = {\n  cleanup: {\n    enabled: true,\n    schedule: 'daily', // daily, weekly, monthly\n    time: '03:00',\n    rules: [\n      {\n        id: 'old_emails',\n        name: 'Old emails',\n        enabled: true,\n        condition: 'age',\n        value: 90, // days\n        action: 'archive' // archive, delete\n      },\n      {\n        id: 'low_score',\n        name: 'Low Lead Score',\n        enabled: true,\n        condition: 'leadScore',\n        value: 20, // below this value\n        afterDays: 30,\n        action: 'archive'\n      },\n      {\n        id: 'resolved',\n        name: 'Resolved dialogs',\n        enabled: true,\n        condition: 'status',\n        value: 'resolved',\n        afterDays: 60,\n        action: 'archive'\n      },\n      {\n        id: 'no_activity',\n        name: 'No activity',\n        enabled: true,\n        condition: 'inactivity',\n        value: 45, // days without activity\n        action: 'archive'\n      }\n    ],\n    archive: {\n      enabled: true,\n      location: 'archive_table',\n      keepAnalysis: true,\n      keepContacts: true\n    },\n    statistics: {\n      lastCleanup: '2025-09-10T03:00:00Z',\n      deletedCount: 0,\n      archivedCount: 127,\n      nextScheduled: '2025-09-11T03:00:00Z'\n    }\n  }\n};\n\nreturn [{json: cleanupSettings}];"
      },
      "id": "e723133c-f564-4167-bfea-bf3643f8b909",
      "name": "ğŸ“‹ Get Cleanup Settings",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        352,
        136
      ]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ $json }}",
        "options": {}
      },
      "id": "84f164a5-1d77-46d5-898c-c7ebec383a0d",
      "name": "ğŸ“¤ Send Cleanup Settings",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        544,
        136
      ]
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "update-email-cleanup-settings",
        "responseMode": "responseNode",
        "options": {
          "allowedOrigins": "*"
        }
      },
      "id": "d7fa1f0c-9184-431c-8a9a-11deef04623d",
      "name": "ğŸŒ Webhook: Update Cleanup",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        -144,
        480
      ],
      "webhookId": "update-email-cleanup-settings-webhook"
    },
    {
      "parameters": {
        "jsCode": "// ============================================\n// ğŸ” UNIVERSAL PROTECTION: API KEY + RATE LIMITING\n// ============================================\n\n// Get settings from CONFIG\nconst config = $('âš™ï¸ CONFIG').first().json;\nconst API_KEY = config.api_key;\nconst RATE_LIMIT_WINDOW_MS = config.rate_limit_window_ms;\nconst RATE_LIMIT_MAX_REQUESTS = config.rate_limit_max_requests;\n\nconst inputData = $('ğŸŒ Webhook: Update Cleanup').item.json;\nconst body = inputData.body || {};\nconst headers = inputData.headers || {};\nconst query = inputData.query || {};\nconst clientIP = headers['x-real-ip'] || headers['x-forwarded-for'] || headers['cf-connecting-ip'] || 'unknown';\nconst now = Date.now();\n\n// RATE LIMITING\nconst staticData = $getWorkflowStaticData('global');\nif (!staticData.rateLimits) { staticData.rateLimits = {}; }\nfor (const ip in staticData.rateLimits) {\n  if (now - staticData.rateLimits[ip].firstRequest > RATE_LIMIT_WINDOW_MS) {\n    delete staticData.rateLimits[ip];\n  }\n}\nif (!staticData.rateLimits[clientIP]) {\n  staticData.rateLimits[clientIP] = { count: 1, firstRequest: now };\n} else {\n  staticData.rateLimits[clientIP].count++;\n  if (staticData.rateLimits[clientIP].count > RATE_LIMIT_MAX_REQUESTS) {\n    return [{ json: { ...inputData, authorized: false, error: { success: false, error: 'Too many requests', details: `Limit: ${RATE_LIMIT_MAX_REQUESTS} requests per minute`, status: 429, retryAfter: Math.ceil((staticData.rateLimits[clientIP].firstRequest + RATE_LIMIT_WINDOW_MS - now) / 1000) } } }];\n  }\n}\n\n// API KEY CHECK\nconst providedKey = headers['x-api-key'] || body.apiKey || query.apiKey || '';\nif (!providedKey) {\n  return [{ json: { ...inputData, authorized: false, error: { success: false, error: 'API key not provided', status: 401 } } }];\n}\nif (providedKey !== API_KEY) {\n  return [{ json: { ...inputData, authorized: false, error: { success: false, error: 'Invalid API key', status: 401 } } }];\n}\n\nreturn [{ json: { ...inputData, authorized: true } }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        16,
        480
      ],
      "id": "security-update",
      "name": "ğŸ” Security (Update)"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 2
          },
          "conditions": [
            {
              "id": "auth-condition",
              "leftValue": "={{ $json.authorized }}",
              "rightValue": "",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        176,
        480
      ],
      "id": "auth-update",
      "name": "ğŸ”€ Auth (Update)"
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ $json.error }}",
        "options": {
          "responseCode": "={{ $json.error.status }}"
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        352,
        576
      ],
      "id": "error-update",
      "name": "âŒ Error (Update)"
    },
    {
      "parameters": {
        "jsCode": "// Get new settings from request\nconst newSettings = $('ğŸŒ Webhook: Update Cleanup').item.json.body || $('ğŸŒ Webhook: Update Cleanup').item.json;\n\n// Here should be the logic to save to DB\n// For example, just return success\n\nreturn [{\n  json: {\n    status: 'success',\n    message: 'Email cleanup settings updated',\n    settings: newSettings,\n    updatedAt: new Date().toISOString()\n  }\n}];"
      },
      "id": "b604d68c-f35d-433b-b4ca-299423c5f233",
      "name": "ğŸ“ Update Cleanup Logic",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        352,
        416
      ]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ $json }}",
        "options": {}
      },
      "id": "ceda0e62-0569-4f65-ad4f-61447457d1d4",
      "name": "ğŸ“¤ Send Update Result",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        544,
        416
      ]
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "hours"
            }
          ]
        }
      },
      "id": "70b5c588-e950-4758-86c9-47c958ab51a3",
      "name": "â° Auto Analysis Schedule",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.1,
      "position": [
        -144,
        720
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "={{ $('âš™ï¸ CONFIG').first().json.batch_analysis_webhook }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "x-api-key",
              "value": "={{ $('âš™ï¸ CONFIG').first().json.api_key }}"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"type\": \"batch\",\n  \"language\": \"all\"\n}",
        "options": {
          "response": {
            "response": {
              "neverError": true
            }
          },
          "timeout": 120000
        }
      },
      "id": "a0bab675-ee0e-4a74-a48c-db646d07326b",
      "name": "ğŸš€ Trigger Batch Analysis",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        64,
        720
      ]
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "triggerAtHour": 3
            }
          ]
        }
      },
      "id": "4c9f3a44-9ca2-4a65-8006-5a51f74ce02d",
      "name": "â° Cleanup Schedule",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.1,
      "position": [
        -144,
        912
      ]
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "=-- Archive old email records\nBEGIN;\n\n-- Archive old records from email_monitoring\nINSERT INTO {{ $('âš™ï¸ CONFIG').first().json.table_email_monitoring_archive }} \nSELECT * FROM {{ $('âš™ï¸ CONFIG').first().json.table_email_monitoring }} \nWHERE \n  (last_activity_time < NOW() - INTERVAL '90 days')\n  OR (lead_score < 20 AND last_activity_time < NOW() - INTERVAL '30 days')\n  OR (status = 'resolved' AND last_activity_time < NOW() - INTERVAL '60 days');\n\n-- Delete archived records\nDELETE FROM {{ $('âš™ï¸ CONFIG').first().json.table_email_monitoring }} \nWHERE \n  (last_activity_time < NOW() - INTERVAL '90 days')\n  OR (lead_score < 20 AND last_activity_time < NOW() - INTERVAL '30 days')\n  OR (status = 'resolved' AND last_activity_time < NOW() - INTERVAL '60 days');\n\n-- Clean old logs\nDELETE FROM {{ $('âš™ï¸ CONFIG').first().json.table_email_processing_log }} \nWHERE processed_at < NOW() - INTERVAL '30 days';\n\nCOMMIT;\n\nSELECT \n  'cleanup_completed' as status,\n  COUNT(*) as archived_count\nFROM {{ $('âš™ï¸ CONFIG').first().json.table_email_monitoring_archive }}\nWHERE created_at >= NOW() - INTERVAL '1 minute';",
        "options": {}
      },
      "id": "8612c9fa-5c5f-4e14-bf10-829ca3eb4154",
      "name": "ğŸ§¹ Execute Cleanup",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        64,
        912
      ],
      "credentials": {
        "postgres": {
          "id": "dPjh4Kdb4nIbCTQG",
          "name": "Postgres account"
        }
      }
    }
  ],
  "pinData": {},
  "connections": {
    "âš™ï¸ CONFIG": {
      "main": [
        [
          {
            "node": "ğŸŒ Webhook: Auto Settings",
            "type": "main",
            "index": 0
          },
          {
            "node": "ğŸŒ Webhook: Cleanup Settings",
            "type": "main",
            "index": 0
          },
          {
            "node": "ğŸŒ Webhook: Update Cleanup",
            "type": "main",
            "index": 0
          },
          {
            "node": "â° Auto Analysis Schedule",
            "type": "main",
            "index": 0
          },
          {
            "node": "â° Cleanup Schedule",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸŒ Webhook: Auto Settings": {
      "main": [
        [
          {
            "node": "ğŸ” Security (Auto)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ” Security (Auto)": {
      "main": [
        [
          {
            "node": "ğŸ”€ Auth (Auto)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ”€ Auth (Auto)": {
      "main": [
        [
          {
            "node": "ğŸ“‹ Get Auto Settings",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "âŒ Error (Auto)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“‹ Get Auto Settings": {
      "main": [
        [
          {
            "node": "ğŸ“¤ Send Auto Settings",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸŒ Webhook: Cleanup Settings": {
      "main": [
        [
          {
            "node": "ğŸ” Security (Cleanup)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ” Security (Cleanup)": {
      "main": [
        [
          {
            "node": "ğŸ”€ Auth (Cleanup)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ”€ Auth (Cleanup)": {
      "main": [
        [
          {
            "node": "ğŸ“‹ Get Cleanup Settings",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "âŒ Error (Cleanup)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“‹ Get Cleanup Settings": {
      "main": [
        [
          {
            "node": "ğŸ“¤ Send Cleanup Settings",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸŒ Webhook: Update Cleanup": {
      "main": [
        [
          {
            "node": "ğŸ” Security (Update)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ” Security (Update)": {
      "main": [
        [
          {
            "node": "ğŸ”€ Auth (Update)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ”€ Auth (Update)": {
      "main": [
        [
          {
            "node": "ğŸ“ Update Cleanup Logic",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "âŒ Error (Update)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“ Update Cleanup Logic": {
      "main": [
        [
          {
            "node": "ğŸ“¤ Send Update Result",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "â° Auto Analysis Schedule": {
      "main": [
        [
          {
            "node": "ğŸš€ Trigger Batch Analysis",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "â° Cleanup Schedule": {
      "main": [
        [
          {
            "node": "ğŸ§¹ Execute Cleanup",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "04c9638b-95b5-4ea3-9f92-ebc85f50106c",
  "meta": {
    "instanceId": "9a2a948e1b1119e76dce477f4f08641c41898f344f4216cb90098437b1dcaf00"
  },
  "id": "JpyVU7czxPSYH4VL",
  "tags": []
}
