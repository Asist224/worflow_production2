{
  "name": "ğŸ“‡ Email Contact Extractor [Production RU]",
  "nodes": [
    {
      "parameters": {
        "content": "## ğŸ“‡ Email Contact Extractor - Ğ˜Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğµ ĞšĞ¾Ğ½Ñ‚Ğ°ĞºÑ‚Ğ¾Ğ²\n\n### ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ\nĞ­Ñ‚Ğ¾Ñ‚ workflow Ğ¸Ğ·Ğ²Ğ»ĞµĞºĞ°ĞµÑ‚ ĞºĞ¾Ğ½Ñ‚Ğ°ĞºÑ‚Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ğ¾Ğ² Ğ¸Ğ· email-Ğ¿ĞµÑ€ĞµĞ¿Ğ¸ÑĞºĞ¸\nÑ Ğ¿Ğ¾Ğ¼Ğ¾Ñ‰ÑŒÑ AI: Ğ¸Ğ¼ĞµĞ½Ğ°, Ñ‚ĞµĞ»ĞµÑ„Ğ¾Ğ½Ñ‹, ĞºĞ¾Ğ¼Ğ¿Ğ°Ğ½Ğ¸Ğ¸, Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ÑÑ‚Ğ¸, LinkedIn Ğ¸ Ğ´Ñ€.\n\n---\n\n### ğŸ”§ ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ°\n\n1. **ĞÑ‚ĞºÑ€Ğ¾Ğ¹Ñ‚Ğµ ÑƒĞ·Ğ»Ñ‹ `âš™ï¸ CONFIG`** Ğ¸ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹Ñ‚Ğµ:\n   - `api_key` â€” Ğ²Ğ°Ñˆ API ĞºĞ»ÑÑ‡ Ğ´Ğ»Ñ Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ñ‹ endpoint\n   - `rate_limit_window_ms` â€” Ğ¾ĞºĞ½Ğ¾ Ğ´Ğ»Ñ rate limiting (Ğ¼Ñ)\n   - `rate_limit_max_requests` â€” Ğ¼Ğ°ĞºÑĞ¸Ğ¼ÑƒĞ¼ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ² Ğ² Ğ¾ĞºĞ½Ğµ\n   - ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ñ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ† PostgreSQL\n\n2. **ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡Ğ¸Ñ‚Ğµ PostgreSQL** credential Ğº ÑƒĞ·Ğ»Ğ°Ğ¼ Ğ‘Ğ”\n\n3. **ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡Ğ¸Ñ‚Ğµ Google Gemini API** credential\n\n4. **ĞĞºÑ‚Ğ¸Ğ²Ğ¸Ñ€ÑƒĞ¹Ñ‚Ğµ workflow**\n\n---\n\n### ğŸ“¡ API Endpoints\n\n#### 1. Ğ˜Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğµ ĞºĞ¾Ğ½Ñ‚Ğ°ĞºÑ‚Ğ¾Ğ²\n**POST** `/webhook/extract-email-contact`\n\n**Headers:**\n```\nContent-Type: application/json\nx-api-key: Ğ²Ğ°Ñˆ_api_key\n```\n\n**Body:**\n```json\n{\n  \"email\": \"client@example.com\",\n  \"type\": \"single\"\n}\n```\n\n#### 2. ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ ĞºĞ¾Ğ½Ñ‚Ğ°ĞºÑ‚Ğ¾Ğ²\n**GET** `/webhook/get-email-contact-data`\n\n**Headers:**\n```\nx-api-key: Ğ²Ğ°Ñˆ_api_key\n```"
      },
      "id": "sticky-note-instructions",
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -2100,
        -200
      ]
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "extract-email-contact",
        "responseMode": "responseNode",
        "options": {
          "allowedOrigins": "*",
          "responseHeaders": {
            "entries": [
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          }
        }
      },
      "id": "948918ec-9e8f-4ef6-9303-048180a271eb",
      "name": "ğŸŒ Webhook: Extract Contact",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        -1728,
        -16
      ],
      "webhookId": "extract-email-contact-webhook"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "api-key",
              "name": "api_key",
              "value": "your-api-key-here",
              "type": "string"
            },
            {
              "id": "rate-window",
              "name": "rate_limit_window_ms",
              "value": 60000,
              "type": "number"
            },
            {
              "id": "rate-max",
              "name": "rate_limit_max_requests",
              "value": 60,
              "type": "number"
            },
            {
              "id": "table-conversations",
              "name": "table_gmail_conversations",
              "value": "gmail_conversations",
              "type": "string"
            },
            {
              "id": "table-contact-data",
              "name": "table_email_contact_data",
              "value": "email_contact_data",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "id": "config-node-extract",
      "name": "âš™ï¸ CONFIG (Extract)",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -1552,
        -16
      ]
    },
    {
      "parameters": {
        "jsCode": "// ============================================\n// ğŸ” Ğ£ĞĞ˜Ğ’Ğ•Ğ Ğ¡ĞĞ›Ğ¬ĞĞĞ¯ Ğ—ĞĞ©Ğ˜Ğ¢Ğ: API KEY + RATE LIMITING\n// ============================================\n\n// ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµĞ¼ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ¸Ğ· CONFIG\nconst config = $('âš™ï¸ CONFIG (Extract)').first().json;\nconst API_KEY = config.api_key;\nconst RATE_LIMIT_WINDOW_MS = config.rate_limit_window_ms;\nconst RATE_LIMIT_MAX_REQUESTS = config.rate_limit_max_requests;\n\nconst inputData = $('ğŸŒ Webhook: Extract Contact').item.json;\nconst body = inputData.body || {};\nconst headers = inputData.headers || {};\nconst query = inputData.query || {};\nconst clientIP = headers['x-real-ip'] || headers['x-forwarded-for'] || headers['cf-connecting-ip'] || 'unknown';\nconst now = Date.now();\n\n// RATE LIMITING\nconst staticData = $getWorkflowStaticData('global');\nif (!staticData.rateLimits) { staticData.rateLimits = {}; }\nfor (const ip in staticData.rateLimits) {\n  if (now - staticData.rateLimits[ip].firstRequest > RATE_LIMIT_WINDOW_MS) {\n    delete staticData.rateLimits[ip];\n  }\n}\nif (!staticData.rateLimits[clientIP]) {\n  staticData.rateLimits[clientIP] = { count: 1, firstRequest: now };\n} else {\n  staticData.rateLimits[clientIP].count++;\n  if (staticData.rateLimits[clientIP].count > RATE_LIMIT_MAX_REQUESTS) {\n    return [{ json: { ...inputData, authorized: false, error: { success: false, error: 'Too many requests', details: `Limit: ${RATE_LIMIT_MAX_REQUESTS} requests per minute`, status: 429, retryAfter: Math.ceil((staticData.rateLimits[clientIP].firstRequest + RATE_LIMIT_WINDOW_MS - now) / 1000) } } }];\n  }\n}\n\n// API KEY CHECK\nconst providedKey = headers['x-api-key'] || body.apiKey || query.apiKey || '';\nif (!providedKey) {\n  return [{ json: { ...inputData, authorized: false, error: { success: false, error: 'API key not provided', status: 401 } } }];\n}\nif (providedKey !== API_KEY) {\n  return [{ json: { ...inputData, authorized: false, error: { success: false, error: 'Invalid API key', status: 401 } } }];\n}\n\nreturn [{ json: { ...inputData, authorized: true, config: config } }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1376,
        -16
      ],
      "id": "0e58ade8-0d86-47a3-ad69-96a3df772bca",
      "name": "ğŸ” Security Check (Extract)"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 2
          },
          "conditions": [
            {
              "id": "auth-condition",
              "leftValue": "={{ $json.authorized }}",
              "rightValue": "",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -1200,
        -16
      ],
      "id": "ca1e219e-0b9e-44d4-ace5-6daa27d58974",
      "name": "ğŸ”€ Auth Check (Extract)"
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ $json.error }}",
        "options": {
          "responseCode": "={{ $json.error.status }}"
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        -1000,
        80
      ],
      "id": "32c69139-539a-4002-aa9f-1ead0801d252",
      "name": "âŒ Error Response (Extract)"
    },
    {
      "parameters": {
        "jsCode": "// ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµĞ¼ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ° Ğ¸ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³\nconst requestData = $('ğŸŒ Webhook: Extract Contact').item.json.body || $('ğŸŒ Webhook: Extract Contact').item.json;\nconst config = $json.config;\nconst email = requestData.email;\nconst threadId = requestData.threadId;\nconst extractionType = requestData.type || 'single';\n\nreturn [{\n    json: {\n        email: email,\n        threadId: threadId,\n        extractionType: extractionType,\n        config: config\n    }\n}];"
      },
      "id": "4e5e32f3-d0a3-408b-b935-713014c6ed8f",
      "name": "ğŸ“¥ Process Extract Request",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1000,
        -96
      ]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 1
          },
          "conditions": [
            {
              "leftValue": "={{ $json.extractionType }}",
              "rightValue": "single",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "c506b830-4e7f-4bff-a8f4-4855e05a9a4a",
      "name": "ğŸ”€ Extraction Type?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [
        -800,
        -96
      ]
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "=-- ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµĞ¼ email Ğ´Ğ¸Ğ°Ğ»Ğ¾Ğ³ Ğ´Ğ»Ñ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ñ ĞºĞ¾Ğ½Ñ‚Ğ°ĞºÑ‚Ğ¾Ğ²\nSELECT \n    email,\n    thread_id,\n    subject,\n    messages,\n    status,\n    language,\n    message_count\nFROM {{ $json.config.table_gmail_conversations }}\nWHERE email = '{{ $json.email }}'\nORDER BY updated_at DESC\nLIMIT 1;",
        "options": {}
      },
      "id": "b7344456-dfc9-42fb-b225-80e916db94cf",
      "name": "ğŸ“§ Get Single Email",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -592,
        -192
      ],
      "credentials": {
        "postgres": {
          "id": "dPjh4Kdb4nIbCTQG",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "=-- ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµĞ¼ Ğ²ÑĞµ Ğ½ĞµĞ´Ğ°Ğ²Ğ½Ğ¸Ğµ email Ğ´Ğ¸Ğ°Ğ»Ğ¾Ğ³Ğ¸ Ğ´Ğ»Ñ Ğ¿Ğ°ĞºĞµÑ‚Ğ½Ğ¾Ğ¹ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸\nWITH recent_emails AS (\n    SELECT \n        email,\n        MAX(updated_at) as last_update\n    FROM {{ $('ğŸ“¥ Process Extract Request').first().json.config.table_gmail_conversations }}\n    WHERE updated_at > NOW() - INTERVAL '24 hours'\n    GROUP BY email\n),\nnot_extracted AS (\n    SELECT re.email\n    FROM recent_emails re\n    LEFT JOIN {{ $('ğŸ“¥ Process Extract Request').first().json.config.table_email_contact_data }} ecd ON re.email = ecd.email\n    WHERE ecd.email IS NULL OR ecd.last_updated < re.last_update\n    LIMIT 50\n)\nSELECT \n    gc.email,\n    gc.thread_id,\n    gc.subject,\n    gc.messages,\n    gc.language,\n    gc.message_count\nFROM {{ $('ğŸ“¥ Process Extract Request').first().json.config.table_gmail_conversations }} gc\nINNER JOIN not_extracted ne ON gc.email = ne.email\nORDER BY gc.updated_at DESC;",
        "options": {}
      },
      "id": "e40f5258-34b4-4f69-ba0f-845a9083eb4f",
      "name": "ğŸ“§ Get Batch Emails",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -592,
        0
      ],
      "credentials": {
        "postgres": {
          "id": "dPjh4Kdb4nIbCTQG",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ¸Ñ€ÑƒĞµĞ¼ email Ğ´Ğ¸Ğ°Ğ»Ğ¾Ğ³Ğ¸ Ğ´Ğ»Ñ AI Ğ°Ğ³ĞµĞ½Ñ‚Ğ°\n// Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµĞ¼ config Ğ´Ğ»Ñ Ğ´Ğ°Ğ»ÑŒĞ½ĞµĞ¹ÑˆĞµĞ³Ğ¾ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ\nconst config = $('ğŸ“¥ Process Extract Request').first().json.config;\nconst dialogs = items;\nconst dialogsForExtraction = [];\n\ndialogs.forEach(item => {\n    const data = item.json;\n    \n    // ĞŸĞ°Ñ€ÑĞ¸Ğ¼ messages\n    let messages = [];\n    try {\n        messages = typeof data.messages === 'string' \n            ? JSON.parse(data.messages) \n            : data.messages || [];\n    } catch (e) {\n        messages = [];\n    }\n    \n    // Ğ¤Ğ¾Ñ€Ğ¼Ğ¸Ñ€ÑƒĞµĞ¼ Ğ´Ğ¸Ğ°Ğ»Ğ¾Ğ³ Ğ´Ğ»Ñ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ñ\n    const conversation = messages.map(msg => \n        `${msg.type === 'incoming' ? 'ĞšĞ»Ğ¸ĞµĞ½Ñ‚' : 'ĞšĞ¾Ğ¼Ğ¿Ğ°Ğ½Ğ¸Ñ'}: ${msg.content}`\n    ).join('\\n');\n    \n    dialogsForExtraction.push({\n        email: data.email,\n        threadId: data.thread_id,\n        subject: data.subject,\n        language: data.language,\n        conversation: conversation\n    });\n});\n\nreturn [{\n    json: {\n        dialogs: dialogsForExtraction,\n        totalDialogs: dialogsForExtraction.length,\n        config: config\n    }\n}];"
      },
      "id": "952d0615-2f93-405d-91f8-5a3d6159ebe2",
      "name": "ğŸ“ Format for Extraction",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -320,
        -96
      ]
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=ĞšĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ´Ğ¸Ğ°Ğ»Ğ¾Ğ³Ğ¾Ğ²: {{ $json.totalDialogs }}\n\nEmail Ğ´Ğ¸Ğ°Ğ»Ğ¾Ğ³Ğ¸ Ğ´Ğ»Ñ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ°:\n{{ $json.dialogs.map((d, i) => `\\n--- Email Ğ´Ğ¸Ğ°Ğ»Ğ¾Ğ³ ${i+1} (Email: ${d.email}) ---\\nĞ¢ĞµĞ¼Ğ°: ${d.subject}\\nĞ¯Ğ·Ñ‹Ğº: ${d.language}\\n${d.conversation}`).join('\\n\\n') }}",
        "options": {
          "systemMessage": "#Ğ Ğ¾Ğ»ÑŒ: Ğ’Ñ‹ â€” ÑĞ¿ĞµÑ†Ğ¸Ğ°Ğ»Ğ¸ÑÑ‚ Ğ¿Ğ¾ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ñ ĞºĞ¾Ğ½Ñ‚Ğ°ĞºÑ‚Ğ½Ñ‹Ñ… Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ¸Ğ· email-Ğ¿ĞµÑ€ĞµĞ¿Ğ¸ÑĞºĞ¸.\n\n#Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ°: ĞŸÑ€Ğ¾Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ email-Ğ´Ğ¸Ğ°Ğ»Ğ¾Ğ³Ğ¸ Ğ¸ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ÑŒ Ğ²ÑĞµ ĞºĞ¾Ğ½Ñ‚Ğ°ĞºÑ‚Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ğ¾Ğ².\n\n#ĞšĞ Ğ˜Ğ¢Ğ˜Ğ§Ğ•Ğ¡ĞšĞ˜ Ğ’ĞĞ–ĞĞĞ• ĞŸĞ ĞĞ’Ğ˜Ğ›Ğ ĞŸĞ EMAIL:\n- Email Ğ°Ğ´Ñ€ĞµÑ ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ğ° Ğ£Ğ–Ğ• Ğ¸Ğ·Ğ²ĞµÑÑ‚ĞµĞ½ - Ğ¾Ğ½ Ğ² Ğ¿Ğ¾Ğ»Ğµ \"Email:\" Ğ² Ğ½Ğ°Ñ‡Ğ°Ğ»Ğµ Ğ´Ğ¸Ğ°Ğ»Ğ¾Ğ³Ğ°\n- ĞĞ• Ğ½ÑƒĞ¶Ğ½Ğ¾ Ğ¸ÑĞºĞ°Ñ‚ÑŒ email Ğ² Ñ‚ĞµĞºÑÑ‚Ğµ Ğ¿ĞµÑ€ĞµĞ¿Ğ¸ÑĞºĞ¸\n- Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ email Ğ¸Ğ· Ğ·Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²ĞºĞ° Ğ´Ğ¸Ğ°Ğ»Ğ¾Ğ³Ğ°\n\n#Ğ˜Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸Ğ¸ Ğ¿Ğ¾ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ñ:\n\n1. **Ğ˜Ğ¼Ñ ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ğ°**:\n   - ĞŸĞ Ğ˜ĞĞ Ğ˜Ğ¢Ğ•Ğ¢ 1: ĞŸĞ¾Ğ´Ğ¿Ğ¸ÑÑŒ Ğ² ĞºĞ¾Ğ½Ñ†Ğµ Ğ¿Ğ¸ÑÑŒĞ¼Ğ° ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ğ°\n   - ĞŸĞ Ğ˜ĞĞ Ğ˜Ğ¢Ğ•Ğ¢ 2: ĞŸÑ€ĞµĞ´ÑÑ‚Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ² Ñ‚ĞµĞºÑÑ‚Ğµ Ğ¿Ğ¸ÑÑŒĞ¼Ğ°\n   - ĞŸĞ Ğ˜ĞĞ Ğ˜Ğ¢Ğ•Ğ¢ 3: ĞĞ±Ñ€Ğ°Ñ‰ĞµĞ½Ğ¸Ğµ Ğ¾Ñ‚ ĞºĞ¾Ğ¼Ğ¿Ğ°Ğ½Ğ¸Ğ¸ Ğº ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ñƒ\n\n2. **Ğ¢ĞµĞ»ĞµÑ„Ğ¾Ğ½**: Ğ˜Ñ‰Ğ¸Ñ‚Ğµ Ğ² Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞ¸ Ğ¿Ğ¸ÑÑŒĞ¼Ğ° Ğ¸Ğ»Ğ¸ Ğ² Ñ‚ĞµĞºÑÑ‚Ğµ\n\n3. **ĞšĞ¾Ğ¼Ğ¿Ğ°Ğ½Ğ¸Ñ Ğ¸ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ÑÑ‚ÑŒ**: Ğ’ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞ¸ Ğ¿Ğ¸ÑÑŒĞ¼Ğ° Ğ¸Ğ»Ğ¸ Ğ¿Ñ€Ğ¸ Ğ¿Ñ€ĞµĞ´ÑÑ‚Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğ¸\n\n4. **Ğ”Ğ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ°Ñ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ**: LinkedIn, ÑĞ°Ğ¹Ñ‚, Ğ¼ĞµÑÑĞµĞ½Ğ´Ğ¶ĞµÑ€Ñ‹\n\n#ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»Ğ°:\n- Ğ˜Ğ·Ğ²Ğ»ĞµĞºĞ°Ğ¹Ñ‚Ğµ Ğ¢ĞĞ›Ğ¬ĞšĞ ÑĞ²Ğ½Ğ¾ ÑƒĞºĞ°Ğ·Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ\n- ĞĞ• Ğ¿Ñ€Ğ¸Ğ´ÑƒĞ¼Ñ‹Ğ²Ğ°Ğ¹Ñ‚Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ\n- Email Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ğ¸Ğ· Ğ·Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²ĞºĞ° Ğ´Ğ¸Ğ°Ğ»Ğ¾Ğ³Ğ°\n\n#Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚ Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ° - Ñ‡Ğ¸ÑÑ‚Ñ‹Ğ¹ JSON:\n{\n  \"contacts\": [\n    {\n      \"email\": \"email Ğ¸Ğ· Ğ·Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²ĞºĞ° Ğ´Ğ¸Ğ°Ğ»Ğ¾Ğ³Ğ°\",\n      \"threadId\": \"thread_id ĞµÑĞ»Ğ¸ ĞµÑÑ‚ÑŒ\",\n      \"name\": \"Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ğµ Ğ¸Ğ¼Ñ Ğ¸Ğ»Ğ¸ null\",\n      \"firstName\": \"Ğ¸Ğ¼Ñ Ğ¸Ğ»Ğ¸ null\",\n      \"lastName\": \"Ñ„Ğ°Ğ¼Ğ¸Ğ»Ğ¸Ñ Ğ¸Ğ»Ğ¸ null\",\n      \"phone\": \"Ñ‚ĞµĞ»ĞµÑ„Ğ¾Ğ½ Ğ¸Ğ»Ğ¸ null\",\n      \"phoneRaw\": \"Ñ‚ĞµĞ»ĞµÑ„Ğ¾Ğ½ ĞºĞ°Ğº ÑƒĞºĞ°Ğ·Ğ°Ğ½ Ğ¸Ğ»Ğ¸ null\",\n      \"company\": \"ĞºĞ¾Ğ¼Ğ¿Ğ°Ğ½Ğ¸Ñ Ğ¸Ğ»Ğ¸ null\",\n      \"position\": \"Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ÑÑ‚ÑŒ Ğ¸Ğ»Ğ¸ null\",\n      \"location\": \"Ğ³Ğ¾Ñ€Ğ¾Ğ´/ÑÑ‚Ñ€Ğ°Ğ½Ğ° Ğ¸Ğ»Ğ¸ null\",\n      \"linkedin\": \"LinkedIn Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ Ğ¸Ğ»Ğ¸ null\",\n      \"website\": \"ÑĞ°Ğ¹Ñ‚ Ğ¸Ğ»Ğ¸ null\",\n      \"otherContacts\": {\n        \"whatsapp\": \"Ğ½Ğ¾Ğ¼ĞµÑ€ Ğ¸Ğ»Ğ¸ null\",\n        \"telegram\": \"username Ğ¸Ğ»Ğ¸ null\"\n      },\n      \"extractedFrom\": \"Ğ¾Ñ‚ĞºÑƒĞ´Ğ° Ğ²Ğ·ÑÑ‚Ñ‹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ\",\n      \"confidence\": Ñ‡Ğ¸ÑĞ»Ğ¾ Ğ¾Ñ‚ 0 Ğ´Ğ¾ 100\n    }\n  ]\n}\n\nĞ’Ğ°Ğ¶Ğ½Ğ¾: Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°Ğ¹Ñ‚Ğµ Ğ¢ĞĞ›Ğ¬ĞšĞ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ½Ñ‹Ğ¹ JSON!"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2,
      "position": [
        -96,
        -96
      ],
      "id": "9df58050-bd8c-4e3c-bd0c-b6089614ed63",
      "name": "ğŸ¤– Contact Extractor AI"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        -96,
        80
      ],
      "id": "28352a80-c515-452e-a9d2-ff731555b53a",
      "name": "ğŸ§  Google Gemini",
      "credentials": {
        "googlePalmApi": {
          "id": "abo0BDHSJPM0pgRU",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// ĞŸĞ°Ñ€ÑĞ¸Ğ¼ Ğ¾Ñ‚Ğ²ĞµÑ‚ AI Ğ¸ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑĞµĞ¼ config\nconst config = $('ğŸ“ Format for Extraction').first().json.config;\nconst aiResponse = items[0].json.output || items[0].json.response || items[0].json;\n\nlet contactsData;\ntry {\n    if (typeof aiResponse === 'string') {\n        let cleanJson = aiResponse;\n        const firstBrace = cleanJson.indexOf('{');\n        if (firstBrace > 0) {\n            cleanJson = cleanJson.substring(firstBrace);\n        }\n        const lastBrace = cleanJson.lastIndexOf('}');\n        if (lastBrace !== -1 && lastBrace < cleanJson.length - 1) {\n            cleanJson = cleanJson.substring(0, lastBrace + 1);\n        }\n        cleanJson = cleanJson.replace(/`/g, '');\n        \n        contactsData = JSON.parse(cleanJson);\n    } else {\n        contactsData = aiResponse;\n    }\n    \n    if (!contactsData.contacts || !Array.isArray(contactsData.contacts)) {\n        throw new Error('Invalid response structure');\n    }\n    \n} catch (error) {\n    contactsData = { contacts: [] };\n}\n\nreturn contactsData.contacts.map(contact => ({json: {...contact, config: config}}));"
      },
      "id": "a3c28157-1fde-4795-9aec-8b30dc8e7116",
      "name": "ğŸ“Š Parse AI Response",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        160,
        -96
      ]
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "=-- Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµĞ¼ ĞºĞ¾Ğ½Ñ‚Ğ°ĞºÑ‚Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ email\nINSERT INTO {{ $json.config.table_email_contact_data }} (\n    email,\n    thread_id,\n    full_name,\n    first_name,\n    last_name,\n    phone,\n    phone_raw,\n    company,\n    position,\n    location,\n    linkedin,\n    website,\n    other_contacts,\n    extracted_from,\n    confidence_score,\n    last_updated\n) VALUES (\n    '{{ $json.email }}',\n    {{ $json.threadId ? \"'\" + $json.threadId + \"'\" : 'NULL' }},\n    {{ $json.name ? \"'\" + $json.name.replace(/'/g, \"''\") + \"'\" : 'NULL' }},\n    {{ $json.firstName ? \"'\" + $json.firstName.replace(/'/g, \"''\") + \"'\" : 'NULL' }},\n    {{ $json.lastName ? \"'\" + $json.lastName.replace(/'/g, \"''\") + \"'\" : 'NULL' }},\n    {{ $json.phone ? \"'\" + $json.phone + \"'\" : 'NULL' }},\n    {{ $json.phoneRaw ? \"'\" + $json.phoneRaw + \"'\" : 'NULL' }},\n    {{ $json.company ? \"'\" + $json.company.replace(/'/g, \"''\") + \"'\" : 'NULL' }},\n    {{ $json.position ? \"'\" + $json.position.replace(/'/g, \"''\") + \"'\" : 'NULL' }},\n    {{ $json.location ? \"'\" + $json.location.replace(/'/g, \"''\") + \"'\" : 'NULL' }},\n    {{ $json.linkedin ? \"'\" + $json.linkedin + \"'\" : 'NULL' }},\n    {{ $json.website ? \"'\" + $json.website + \"'\" : 'NULL' }},\n    {{ $json.otherContacts ? \"'\" + JSON.stringify($json.otherContacts).replace(/'/g, \"''\") + \"'::jsonb\" : 'NULL' }},\n    {{ $json.extractedFrom ? \"'\" + $json.extractedFrom.replace(/'/g, \"''\") + \"'\" : \"'unknown'\" }},\n    {{ $json.confidence || 0 }},\n    CURRENT_TIMESTAMP\n)\nON CONFLICT (email)\nDO UPDATE SET\n    thread_id = EXCLUDED.thread_id,\n    full_name = COALESCE(EXCLUDED.full_name, {{ $json.config.table_email_contact_data }}.full_name),\n    first_name = COALESCE(EXCLUDED.first_name, {{ $json.config.table_email_contact_data }}.first_name),\n    last_name = COALESCE(EXCLUDED.last_name, {{ $json.config.table_email_contact_data }}.last_name),\n    phone = COALESCE(EXCLUDED.phone, {{ $json.config.table_email_contact_data }}.phone),\n    phone_raw = COALESCE(EXCLUDED.phone_raw, {{ $json.config.table_email_contact_data }}.phone_raw),\n    company = COALESCE(EXCLUDED.company, {{ $json.config.table_email_contact_data }}.company),\n    position = COALESCE(EXCLUDED.position, {{ $json.config.table_email_contact_data }}.position),\n    location = COALESCE(EXCLUDED.location, {{ $json.config.table_email_contact_data }}.location),\n    linkedin = COALESCE(EXCLUDED.linkedin, {{ $json.config.table_email_contact_data }}.linkedin),\n    website = COALESCE(EXCLUDED.website, {{ $json.config.table_email_contact_data }}.website),\n    other_contacts = COALESCE(EXCLUDED.other_contacts, {{ $json.config.table_email_contact_data }}.other_contacts),\n    extracted_from = EXCLUDED.extracted_from,\n    confidence_score = GREATEST(EXCLUDED.confidence_score, {{ $json.config.table_email_contact_data }}.confidence_score),\n    last_updated = CURRENT_TIMESTAMP\nRETURNING *;",
        "options": {}
      },
      "id": "9335fc4c-210a-4c87-83a7-59b7bf7d2eda",
      "name": "ğŸ’¾ Save Contact Data",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        384,
        -96
      ],
      "credentials": {
        "postgres": {
          "id": "dPjh4Kdb4nIbCTQG",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ {\"status\": \"success\", \"message\": \"Email contact data extracted\", \"processed\": $items('ğŸ“Š Parse AI Response').length} }}",
        "options": {}
      },
      "id": "cc9eb30d-986b-49ba-99f6-ce692cf783ba",
      "name": "ğŸ“¤ Send Extract Result",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        608,
        -96
      ]
    },
    {
      "parameters": {
        "path": "get-email-contact-data",
        "responseMode": "responseNode",
        "options": {
          "allowedOrigins": "*"
        }
      },
      "id": "72d7db9d-aafc-45f8-9140-b0a9f3acfac0",
      "name": "ğŸŒ Webhook: Get Contacts",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        -1728,
        336
      ],
      "webhookId": "get-email-contact-data-webhook"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "api-key",
              "name": "api_key",
              "value": "your-api-key-here",
              "type": "string"
            },
            {
              "id": "rate-window",
              "name": "rate_limit_window_ms",
              "value": 60000,
              "type": "number"
            },
            {
              "id": "rate-max",
              "name": "rate_limit_max_requests",
              "value": 60,
              "type": "number"
            },
            {
              "id": "table-conversations",
              "name": "table_gmail_conversations",
              "value": "gmail_conversations",
              "type": "string"
            },
            {
              "id": "table-contact-data",
              "name": "table_email_contact_data",
              "value": "email_contact_data",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "id": "config-node-get",
      "name": "âš™ï¸ CONFIG (Get)",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -1552,
        336
      ]
    },
    {
      "parameters": {
        "jsCode": "// ============================================\n// ğŸ” Ğ£ĞĞ˜Ğ’Ğ•Ğ Ğ¡ĞĞ›Ğ¬ĞĞĞ¯ Ğ—ĞĞ©Ğ˜Ğ¢Ğ: API KEY + RATE LIMITING\n// ============================================\n\n// ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµĞ¼ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ¸Ğ· CONFIG\nconst config = $('âš™ï¸ CONFIG (Get)').first().json;\nconst API_KEY = config.api_key;\nconst RATE_LIMIT_WINDOW_MS = config.rate_limit_window_ms;\nconst RATE_LIMIT_MAX_REQUESTS = config.rate_limit_max_requests;\n\nconst inputData = $('ğŸŒ Webhook: Get Contacts').item.json;\nconst body = inputData.body || {};\nconst headers = inputData.headers || {};\nconst query = inputData.query || {};\nconst clientIP = headers['x-real-ip'] || headers['x-forwarded-for'] || headers['cf-connecting-ip'] || 'unknown';\nconst now = Date.now();\n\n// RATE LIMITING\nconst staticData = $getWorkflowStaticData('global');\nif (!staticData.rateLimits) { staticData.rateLimits = {}; }\nfor (const ip in staticData.rateLimits) {\n  if (now - staticData.rateLimits[ip].firstRequest > RATE_LIMIT_WINDOW_MS) {\n    delete staticData.rateLimits[ip];\n  }\n}\nif (!staticData.rateLimits[clientIP]) {\n  staticData.rateLimits[clientIP] = { count: 1, firstRequest: now };\n} else {\n  staticData.rateLimits[clientIP].count++;\n  if (staticData.rateLimits[clientIP].count > RATE_LIMIT_MAX_REQUESTS) {\n    return [{ json: { ...inputData, authorized: false, error: { success: false, error: 'Too many requests', details: `Limit: ${RATE_LIMIT_MAX_REQUESTS} requests per minute`, status: 429, retryAfter: Math.ceil((staticData.rateLimits[clientIP].firstRequest + RATE_LIMIT_WINDOW_MS - now) / 1000) } } }];\n  }\n}\n\n// API KEY CHECK\nconst providedKey = headers['x-api-key'] || body.apiKey || query.apiKey || '';\nif (!providedKey) {\n  return [{ json: { ...inputData, authorized: false, error: { success: false, error: 'API key not provided', status: 401 } } }];\n}\nif (providedKey !== API_KEY) {\n  return [{ json: { ...inputData, authorized: false, error: { success: false, error: 'Invalid API key', status: 401 } } }];\n}\n\nreturn [{ json: { ...inputData, authorized: true, config: config } }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1376,
        336
      ],
      "id": "20c48036-f798-451d-ae65-552a686d4ef7",
      "name": "ğŸ” Security Check (Get)"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 2
          },
          "conditions": [
            {
              "id": "auth-condition",
              "leftValue": "={{ $json.authorized }}",
              "rightValue": "",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -1200,
        336
      ],
      "id": "56ca0a36-d5ae-4ec4-84c5-83b627072fcd",
      "name": "ğŸ”€ Auth Check (Get)"
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ $json.error }}",
        "options": {
          "responseCode": "={{ $json.error.status }}"
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        -1000,
        432
      ],
      "id": "e987cb2f-97bf-4423-b768-f3af7e0a4a8d",
      "name": "âŒ Error Response (Get)"
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "=SELECT \n    ecd.email,\n    ecd.thread_id,\n    ecd.full_name,\n    ecd.first_name,\n    ecd.last_name,\n    ecd.phone,\n    ecd.phone_raw,\n    ecd.company,\n    ecd.position,\n    ecd.location,\n    ecd.linkedin,\n    ecd.website,\n    ecd.other_contacts,\n    ecd.confidence_score,\n    ecd.extracted_from,\n    ecd.last_updated,\n    gc.lead_score,\n    gc.subject,\n    gc.message_count\nFROM {{ $json.config.table_email_contact_data }} ecd\nLEFT JOIN {{ $json.config.table_gmail_conversations }} gc ON ecd.email = gc.email\nWHERE ecd.last_updated >= NOW() - INTERVAL '30 days'\nORDER BY ecd.last_updated DESC;",
        "options": {}
      },
      "id": "1458fbad-4910-4fb4-918a-f6983665650a",
      "name": "ğŸ“‹ Get Contacts from DB",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -1000,
        272
      ],
      "credentials": {
        "postgres": {
          "id": "dPjh4Kdb4nIbCTQG",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ¸Ñ€ÑƒĞµĞ¼ ĞºĞ¾Ğ½Ñ‚Ğ°ĞºÑ‚Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ email Ğ´Ğ»Ñ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ¸\nconst contacts = {};\n\nitems.forEach(item => {\n    const data = item.json;\n    \n    contacts[data.email] = {\n        email: data.email,\n        threadId: data.thread_id,\n        name: data.full_name || `${data.first_name || ''} ${data.last_name || ''}`.trim() || null,\n        firstName: data.first_name,\n        lastName: data.last_name,\n        phone: data.phone || data.phone_raw,\n        company: data.company,\n        position: data.position,\n        location: data.location,\n        linkedin: data.linkedin,\n        website: data.website,\n        otherContacts: data.other_contacts,\n        leadScore: data.lead_score || 0,\n        subject: data.subject,\n        messageCount: data.message_count || 0,\n        confidence: data.confidence_score,\n        extractedFrom: data.extracted_from,\n        lastUpdated: data.last_updated\n    };\n});\n\nreturn [{json: {contacts}}];"
      },
      "id": "c8db7607-4862-4eb6-8c57-a6e41b464b76",
      "name": "ğŸ“ Format Contacts",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -800,
        272
      ]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ $json }}",
        "options": {}
      },
      "id": "feb11872-b66b-4ef5-afa9-aabfc9465b30",
      "name": "ğŸ“¤ Send Contacts",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        -592,
        272
      ]
    }
  ],
  "pinData": {},
  "connections": {
    "ğŸŒ Webhook: Extract Contact": {
      "main": [
        [
          {
            "node": "âš™ï¸ CONFIG (Extract)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "âš™ï¸ CONFIG (Extract)": {
      "main": [
        [
          {
            "node": "ğŸ” Security Check (Extract)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ” Security Check (Extract)": {
      "main": [
        [
          {
            "node": "ğŸ”€ Auth Check (Extract)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ”€ Auth Check (Extract)": {
      "main": [
        [
          {
            "node": "ğŸ“¥ Process Extract Request",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "âŒ Error Response (Extract)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“¥ Process Extract Request": {
      "main": [
        [
          {
            "node": "ğŸ”€ Extraction Type?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ”€ Extraction Type?": {
      "main": [
        [
          {
            "node": "ğŸ“§ Get Single Email",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "ğŸ“§ Get Batch Emails",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“§ Get Single Email": {
      "main": [
        [
          {
            "node": "ğŸ“ Format for Extraction",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“§ Get Batch Emails": {
      "main": [
        [
          {
            "node": "ğŸ“ Format for Extraction",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“ Format for Extraction": {
      "main": [
        [
          {
            "node": "ğŸ¤– Contact Extractor AI",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ¤– Contact Extractor AI": {
      "main": [
        [
          {
            "node": "ğŸ“Š Parse AI Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ§  Google Gemini": {
      "ai_languageModel": [
        [
          {
            "node": "ğŸ¤– Contact Extractor AI",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“Š Parse AI Response": {
      "main": [
        [
          {
            "node": "ğŸ’¾ Save Contact Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ’¾ Save Contact Data": {
      "main": [
        [
          {
            "node": "ğŸ“¤ Send Extract Result",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸŒ Webhook: Get Contacts": {
      "main": [
        [
          {
            "node": "âš™ï¸ CONFIG (Get)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "âš™ï¸ CONFIG (Get)": {
      "main": [
        [
          {
            "node": "ğŸ” Security Check (Get)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ” Security Check (Get)": {
      "main": [
        [
          {
            "node": "ğŸ”€ Auth Check (Get)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ”€ Auth Check (Get)": {
      "main": [
        [
          {
            "node": "ğŸ“‹ Get Contacts from DB",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "âŒ Error Response (Get)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“‹ Get Contacts from DB": {
      "main": [
        [
          {
            "node": "ğŸ“ Format Contacts",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“ Format Contacts": {
      "main": [
        [
          {
            "node": "ğŸ“¤ Send Contacts",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "d0f35d2b-0fde-4d43-9bab-09f0fff32112",
  "meta": {
    "instanceId": "9a2a948e1b1119e76dce477f4f08641c41898f344f4216cb90098437b1dcaf00"
  },
  "id": "7ZI87A0yNnYEuNkA",
  "tags": []
}
